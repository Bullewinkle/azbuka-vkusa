function slider_product(e,t,a){var r=a.find(".slider_wrapper"),i=r.children().eq(0),n=i.width()+int(i.css("border-left-width"))+int(i.css("border-right-width"))+int(i.css("margin-left"))+int(i.css("margin-right")),o=Math.abs(Math.round(int(r.css("left"))/n)),s=Math.round(r.width()/n),d=s-1,c="+=",l=!0,_=a.attr("data-step_offset")?parseInt(a.attr("data-step_offset")):1,u=r.find(".active"),m=u.prevAll(".item_product_card_photo_min").length,p=a.find(".slider_wrapper_big");"undefined"==typeof a.attr("data-current_offset")&&a.attr("data-current_offset",o),t.removeAttr("disabled");var f=parseInt(a.attr("data-current_offset"));return e.hasClass("right")&&(c="-=",f>=d?l=!1:(f+=_,u.next(".item_product_card_photo_min").addClass("active"),u.removeClass("active"),p.find(".active").removeClass("active"),p.children().eq(m+1).addClass("active"))),e.hasClass("left")&&(0>=f?l=!1:(f-=_,u.prev(".item_product_card_photo_min").addClass("active"),u.removeClass("active"),p.find(".active").removeClass("active"),p.children().eq(m-1).addClass("active"))),0==f&&t.filter(".left").attr("disabled","disabled"),f==d&&t.filter(".right").attr("disabled","disabled"),a.attr("data-current_offset",f),l?(f>2&&d-2>=f&&e.hasClass("right")&&r.animate({left:c+n*_},500),f>=2&&d-2>f&&e.hasClass("left")&&r.animate({left:c+n*_},500),!1):!1}function int(e){return isNaN(parseInt(e))?0:parseInt(e)}function preg_quote(e,t){return(e+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")}function implode(e,t){return t instanceof Array?t.join(e):t}function changeType(e,t){if(e=$(e),e.prop("type")==t)return e;try{return e.prop("type",t)}catch(a){var r=$("<div>").append(e.clone()).html(),n=/type=(\")?([^\"\s]+)(\")?/,o=$(null==r.match(n)?r.replace(">",' type="'+t+'">'):r.replace(n,'type="'+t+'"'));o.data("type",e.data("type"));var s=e.data("events"),d=function(e){return function(){for(i in e){var t=e[i];for(j in t)o.bind(i,t[j].handler)}}}(s);return e.replaceWith(o),setTimeout(d,10),o}}function main_page_silder_change(){var e=$('#main_page_slider li[data-orbit-slide!=""]'),t=e.index($("#main_page_slider li.active")),a=e.eq(t),r=a.find(".orbit_special_caption").html();$(".main_page_slider_controls_label").html(r),$(".main_page_slider_controls_pages button").removeClass("active"),$(".main_page_slider_controls_pages button").eq(t).addClass("active")}function main_page_brands_silder_change(){var e=$('#main_page_brands_slider li[data-orbit-slide!=""]'),t=e.index($("#main_page_brands_slider li.active")),a=e.eq(t),r=a.find(".orbit_special_caption").html();$(".page_slider_controls_label").html(r),$(".page_slider_controls_pages button").removeClass("active"),$(".page_slider_controls_pages button").eq(t).addClass("active")}function fieldPhone(e){$(e).bind("keyup change",function(e){phoneValid(this,e,!0)})}function phoneValid(e,t,a){if("string"!=typeof e.value||t.ctrlKey||"13"==t.keyCode||"37"==t.keyCode||"38"==t.keyCode||"39"==t.keyCode||"40"==t.keyCode||"8"==t.keyCode||"16"==t.keyCode)return!1;var r=getFocusPos(e),i=0,n=0,o=0,s=e.value,d="",c="",l="",_=new Array;_[49646]=5,_[49645]=5,_[49634]=5,_[49636]=5,_[49644]=5,_[49624]=5,_[49633]=5,_[49631]=5,_[49654]=5,_[49622]=5,_[49679]=5,_[4964]=4,_[49621]=5,_[49640]=5,_[49648]=5,_[49666]=5,_[49632]=5,_[49626]=5,_[49669]=5,_[4967]=4,_[4966]=4,_[2538]=4,_[49651]=5,_[49627]=5,_[49656]=5,_[49628]=5,_[49663]=5,_[49638]=5,_[49652]=5,_[49670]=5,_[49643]=5,_[49672]=5,_[49653]=5,_[49667]=5,_[49664]=5,_[49620]=5,_[49637]=5,_[49657]=5," "==s.substr(0,1)&&(s=s.substr(1,100))," "==s.substr(s.length,1)&&(s=s.substr(0,s.length-1));for(var u=0;u<s.length;u++)c=s.substr(u,1)," "!=c&&0==isNaN(c)&&(l+=c,n+=1),u+1!=r||o||(o=n);for(var u=0;u<l.length;u++)c=l.substr(u,1),d+=c,l.length<=10&&"9"!=l.substr(0,1)?"496"==l.substr(0,3)?_[l.substr(0,5)]?(4==u&&(d+=" "),5==u&&(d+="-"),7==u&&(d+="-")):_[l.substr(0,4)]?(3==u&&(d+=" "),5==u&&(d+="-"),7==u&&(d+="-")):(3==u&&(d+=" "),6==u&&(d+="-"),8==u&&(d+="-")):(2==u&&(d+=" "),5==u&&(d+="-"),7==u&&(d+="-")):"9"==l.substr(0,1)&&"10"==l.length?(2==u&&(d+=" "),5==u&&(d+="-"),7==u&&(d+="-")):(2==u||5==u&&l.length>7||9==u||13==u||17==u)&&(d+="-"),u+1!=o||i||(i=d.length);return a&&"-"==d.substr(d.length-1,1)&&(d=d.substr(0,d.length-1)),e.value=d,0==o&&"+"==s.substr(0,1)&&(i+=1),i&&setFocusPos(e,i),!1}function getFocusPos(e){var t=0;if($.browser.msie){var a=e.document.selection.createRange();a.moveStart("textedit",-1),t=a.text.length}else t=e.selectionEnd;return t}function setFocusPos(e,t){if($.browser.msie){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}else e.setSelectionRange(t,t)}function show_time_zone(){$(".background_overlay").show();var e=document.body,t=document.documentElement,a=window.pageYOffset||t.scrollTop||e.scrollTop,r=a+100;$("#time-zone").css({top:r+"px","margin-left":"-360px"}).show()}function show_form_aut(){$(".window_authorization_soc_error").hide(),$(".background_overlay").show();var e=document.body,t=document.documentElement,a=window.pageYOffset||t.scrollTop||e.scrollTop,r=a+100;$("#authorization_form").css({top:r+"px","margin-left":"-260px"}).show(),$("input[name=login]").focus()}function show_form(e){$(".background_overlay").show(),$("#"+e).css({top:"100px","margin-left":"-260px"}).show()}function show_window_agreement(e,t,a){$(".background_overlay").show(),$(".modal_window_agreement_title").html(e);var r=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||r.scrollTop,o=n+200;"address"==t&&($(".ymaps-map").css("z-index","0"),$(".background_overlay").fadeIn("0.1")),"submit_big"==t?$("#window_agreement .submit").addClass("submit_big"):$("#window_agreement .submit").removeClass("submit_big"),a?$("#window_agreement").css({top:o+"px","margin-left":"-260px",position:"fixed"}).show():$("#window_agreement").css({top:o+"px","margin-left":"-260px"}).show()}function show_window_dialog(e,t,a,r){$(".modal_window_dialog_title").html(e),$("#window_dialog .green_btn.submit.button_ok").html(t),$("#window_dialog .green_btn.cancel.button_ok").html(a);var i=document.body,n=document.documentElement,o=window.pageYOffset||n.scrollTop||i.scrollTop,s=o+200;"address"==r&&($(".ymaps-map").css("z-index","0"),$(".background_overlay").fadeIn("0.1")),jQuery(".background_overlay").fadeIn(),$("#window_dialog").css({top:s+"px","margin-left":"-260px"}).show()}function validateForm(e){var t=!0;return e.find(".required").removeClass("error"),e.find(".error_message").remove(),e.find("input.required").each(function(){if(required=$(this),""==$.trim(required.val()))return t=!1,required.addClass("error"),required.after('<div class="fs13 error_message">Необходимо заполнить</div>'),!1;if(""!=$.trim(required.val())&&"login"==required.attr("name")&&!/^(?:[a-z0-9_]+(?:[-_\.\+]?[a-z0-9-_\.]+)?@[a-z0-9\-]+(?:\.?[a-z0-9]+)?\.[a-z]{2,5})$/i.test($.trim(required.val())))return t=!1,required.addClass("error"),required.after('<div class="fs13 error_message">Неверный E-mail</div>'),!1;var a=e.find('input[name = "password"]'),r=e.find('input[name = "password_confirm"]');if(a.length&&r.length){if(a.val().length<8)return t=!1,a.addClass("error"),a.after('<div class="fs13 error_message">Минимально 8 символов</div>'),!1;if(a.val()&&r.val()&&a.val()!=r.val())return t=!1,r.addClass("error"),r.after('<div class="fs13 error_message">Пароли должны совпадать</div>'),!1;r.removeClass("error"),r.next(".error_message").remove()}}),t}function show_success_cart_notififcation(){window.skip_basket_popup_notification!==!0&&($("a#price_cart_original_amount_in_header").attr("href","/personal/basket/cart/"),$(".header_basket_popup_msg").addClass($(document).scrollTop()>140?"open":"open_in_header"),setTimeout(function(){$(".header_basket_popup_msg").removeClass("open").removeClass("open_in_header")},3e3))}function show_success_list_notififcation(e){e?$("a#price_cart_original_amount_in_header").attr("href","/personal/favorites/?number="+e):$("a#price_cart_original_amount_in_header").attr("href","/personal/favorites/"),$(".header_lists_popup_msg").addClass($(document).scrollTop()>140?"open":"open_in_header"),setTimeout(function(){$(".header_lists_popup_msg").removeClass("open").removeClass("open_in_header")},3e3)}function addSpace(e){return e+="",e=new Array(4-e.length%3).join("U")+e,e.replace(/([0-9U]{3})/g,"$1 ").replace(/U/g,"")}function vkusomaniaRounder(e,t){var a=e.toPrecision(5),r=(a.length-1,a[a.length-1]);return r>=t&&(e+=(5-t)/1e3),Math.round(100*e)/100}function update_block_cart(e,t,a){ajax_modify_count_item_cart=!0;var r="/udata/avemarket/basket/";a&&(r+=a+"/"+e+"/"+t),$.ajax({url:r,type:"POST",dataType:"json",async:!1,success:function(t){ajax_modify_count_item_cart=!1;var r=t.item_count_all;r=parseInt(r);var i=t.post_fix_amount,n=t.price_for_free_delivery,o=t.price_cart_original_amount_last,s=$("#price_for_free_delivery_last"),d=$("#price_for_free_delivery_all"),c=$("#price_for_free_delivery");n=n.toString(),n.toString().substring(0,n.toString().indexOf(".")),n>0?("00"==o?(s.html("00"),c.html(n)):(s.html(100-o),c.html(n.toString().substring(0,n.toString().indexOf(".")))),d.show()):d.hide();var l=t.promo_notification;l&&order_controller.gifts.changeGiftNotification(l);var _=t.promo_benefit,u=t.promo_code_type;_&&order_controller.gifts.showPromoBenefit(_,u);var m=t.price_cart_original_amount,p=addSpace(parseInt(m)),f=t.price_cart_original_amount_last,h=addSpace(parseInt(t.price_cart_original_products_amount_first)),v=t.price_cart_original_products_amount_last,g=addSpace(parseInt(t.price_cart_original_dishes_amount_first)),b=t.price_cart_original_dishes_amount_last,y=t.price_cart_discount_card_amount,k=addSpace(parseInt(y));0!=k&&(k="- "+k);var w=t.price_cart_discount_card_amount_last,x=t.price_cart_special_discount_amount||0,C=parseInt(x);if(C>0){$("#price_cart_you_economy_int_div").css("display","block"),x=x.toString().split(".");var T="- "+addSpace(x[0])+" ",S=x[1]?x[1].slice(0,2):"00";S.length<2&&(S+="0")}else $("#price_cart_you_economy_int_div").css("display","none");var A=t.price_cart_special_discount_amount,O=addSpace(parseInt(A));O>0&&(O="- "+O);var j=(t.price_cart_special_discount_amount_last,t.price_cart_voucher_discount_amount_first),I=addSpace(parseInt(j)),P=t.price_cart_voucher_discount_amount_last,E=t.price_cart_delivery_amount,D=addSpace(parseInt(E)),q=t.price_cart_delivery_amount_last,R=t.price_cart_total_amount,M=addSpace(parseInt(R)),U=t.price_cart_total_amount_last,B=.004*(R-E);if("1"===t.has_alcohol||"1"===t.has_tobacco?($(".last>#price_cart_original_amount_in_header").next("div").find("a").html("В корзину"),$("#purchasing").text("Далее"),$("#catalog_to_cart").text("Перейти в корзину")):($(".last>#price_cart_original_amount_in_header").next("div").find("a").html("Оформить"),$("#purchasing").text("Заказать"),$("#catalog_to_cart").text("Оформить заказ")),0==r?("del"==a&&update_cart_block_visual(),$("#price_cart_original_amount_in_header .price_cart").html(m),$("#price_cart_original_amount.price_cart").html(m),$(".live-line-guest-cart .price_cart").html(m),$("#price_cart_discount_card_amount").html(y),$("#price_cart_you_economy_int").html(C),$("#price_cart_delivery_amount").html(E),$("#price_cart_voucher_discount_card_amount").html("- "+j),$("#price_cart_total_amount").html(R),$("#price_cart_vkusomania").html(t.user.discount_card_percentage>0?vkusomaniaRounder(B,4):0),$(".last>#price_cart_original_amount_in_header").html('<i class="icon_cart"></i><span class="amount_cart">Корзина<br></span><span class="p"><span class="price_cart">пуста</span></span>'),$(".last>#price_cart_original_amount_in_header").next("div").addClass("hidden"),$("#price_cart_original_amount.price_cart").append('<span class="price_postfix"> 00</span>'),$("#price_cart_discount_card_amount").append('<span class="price_postfix"> 00</span>'),$("#price_cart_delivery_amount").append('<span class="price_postfix"> 00</span>'),$("#price_cart_total_amount").append('<span class="price_postfix"> 00</span>')):($(".amount_cart").text(r+" "+i),U?($("#price_cart_original_amount_in_header .price_cart").html("на "+p+'<span class="price_postfix fs11"> '+f+"</span>"),$(".live-line-guest-cart .price_cart").html(p+'<span class="price_postfix fs11"> '+f+"</span>"),$("#price_cart_original_amount.price_cart").html(p+'<span class="price_postfix fs11"> '+f+"</span>"),$("#price_cart_discount_card_amount").html(k+'<span class="price_postfix fs11"> '+w+"</span>"),$("#price_cart_you_economy_int").html(T+'<span class="price_postfix fs11"> '+S+"</span>"),$("#price_cart_delivery_amount").html(D+'<span class="price_postfix fs11"> '+q+"</span>"),$("#price_cart_voucher_discount_card_amount").html("- "+I+'<span class="price_postfix fs11"> '+P+"</span>"),$("#price_cart_total_amount").html(M+'<span class="price_postfix fs11"> '+U+"</span>"),$("#price_cart_original_products_amount").html(h+'<span class="price_postfix fs11"> '+v+"</span>"),$("#price_cart_original_dishes_amount").html(g+'<span class="price_postfix fs11"> '+b+"</span>"),$("#price_cart_vkusomania").html(t.user.discount_card_percentage>0?vkusomaniaRounder(B,4):0)):($("#price_cart_original_amount_in_header .price_cart").html(m),$(".live-line-guest-cart .price_cart").html(m),$("#price_cart_original_amount.price_cart").html(m),$("#price_cart_discount_card_amount").html(y),$("#price_cart_you_economy_int").html(C),$("#price_cart_delivery_amount").html(E),$("#price_cart_voucher_discount_card_amount").html("- "+price_cart_voucher_discount_card_amount),$("#price_cart_total_amount").html(R),$("#price_cart_vkusomania").html(t.user.discount_card_percentage>0?vkusomaniaRounder(B,4):0)),"put"==a&&show_success_cart_notififcation(),$(".last>#price_cart_original_amount_in_header").next("div").removeClass("hidden")),t.recalculate_item){var G=t.recalculate_item.id,F=(t.recalculate_item.quantity,t.recalculate_item.price,t.recalculate_item.amount),N=t.recalculate_item.special_discount_amount;F-=N,actualItemPrice(G,F,N),actualItemPrice(G,F,N,".cart_active_elements_block #dynamic_count_"+G)}if(3==t.promo_code_type?$("#gift-contener").trigger("update"):$("#gift-contener").html(""),e&&available_items(e),$("#min_cash_shipping").length>0){var L=t.total_price;L=parseInt(L),t.min_order_price_green?$("#min_cash_shipping").addClass("g-green"):$("#min_cash_shipping").removeClass("g-green"),t.min_order_price_message?$("#min_cash_shipping").find("span").text(t.min_order_price_message).end().css("display","block"):$("#min_cash_shipping").find("span").text("").end().css("display","none"),order_controller.drawButtonIssueOrderGuest(),controlOrderingButtons()}"1"===t.has_alcohol||"1"===t.has_tobacco?($("#payment_credit_cards").attr("checked",!1).attr("disabled",!0).trigger("change").parent().addClass("disabled g-hidden").end().next().removeClass("checked"),$("#payment_credit_cards_images").addClass("g-hidden")):($("#payment_credit_cards").attr("disabled",!1).trigger("change").parent().removeClass("disabled g-hidden"),$("#payment_credit_cards_images").removeClass("g-hidden"));var z=$("#type_payment").find("span.checked").siblings("input").attr("id");"payment_credit_cards"==z?$(".online_description_cardpay").slideDown("fast"):$(".online_description_cardpay").slideUp("fast"),t.documents_verification=1==t.has_energy_drinks&&1==t.delivery_energy_verification&&0==t.has_alcohol&&0==t.has_tobacco?1:1!=t.has_alcohol&&1!=t.has_tobacco||0!=t.has_energy_drinks?1!=t.has_alcohol&&1!=t.has_tobacco||1!=t.has_energy_drinks?0:3:2,1==t.documents_verification?($(".documents_verification").not(".documents_verification__energo").addClass("g-hidden").slideUp(500),$(".documents_verification.documents_verification__energo").removeClass("g-hidden").slideDown(500)):2==t.documents_verification?($(".documents_verification").not(".documents_verification__alcohol").addClass("g-hidden").slideUp(500),$(".documents_verification.documents_verification__alcohol").removeClass("g-hidden").slideDown(500)):3==t.documents_verification?($(".documents_verification").not(".documents_verification__energo-alcohol").addClass("g-hidden").slideUp(500),$(".documents_verification.documents_verification__energo-alcohol").removeClass("g-hidden").slideDown(500)):$(".documents_verification").addClass("g-hidden").slideUp(500),t.has_alcohol!==global_has_alcohol&&(global_has_alcohol=t.has_alcohol,window.timeSlotsUpdate.update=!1),$("#min_order_price").text(t.min_order_price),""!=t.delivery_notification?($("#delivery_notification").find("span").text(t.delivery_notification),$("#delivery_notification").removeClass("g-hidden")):($("#delivery_notification").find("span").text(""),$("#delivery_notification").addClass("g-hidden")),"2"==t.order_type?$("#float_time_or_link").addClass("g-hidden"):$("#float_time_or_link").removeClass("g-hidden"),t.order_type||setSelectedTimeEmpty();var H=$("#products"),K=$("#dishes"),W=$("#uniform"),Q=t.items_count,V=t.dishes_count;Q>0&&V>0?(H.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden").end().find(".b-time-block_defer-msg").removeClass("g-hidden").end().find(".b-time-block__defer-btn").removeClass("g-hidden"),K.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden").end().find(".b-time-block_defer-msg").removeClass("g-hidden").end().find(".b-time-block__defer-btn").removeClass("g-hidden").end().find('[data-deferred="empty"]').addClass("g-hidden"),W.find('[data-button="time_slot_ok"]').removeClass("grey_btn g-hidden"),W.find(".slot_time.active").length||W.find('[data-button="time_slot_ok"]').addClass("g-hidden")):0==Q&&V>0?(H.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden").end().find(".b-time-block_defer-msg").removeClass("g-hidden").end().find(".b-time-block__defer-btn").removeClass("g-hidden"),K.find('[data-button="time_slot_ok"]').removeClass("grey_btn").end().find(".b-time-block_defer-msg").addClass("g-hidden").end().find(".b-time-block__defer-btn").addClass("g-hidden").end().find('[data-deferred="empty"]').addClass("g-hidden"),W.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden"),K.find(".slot_time.not_active").hasClass("active")||K.find('[data-button="time_slot_ok"]').removeClass("grey_btn g-hidden"),K.find(".slot_time.active").length||K.find('[data-button="time_slot_ok"]').addClass("g-hidden")):Q>0&&0==V?(H.find('[data-button="time_slot_ok"]').removeClass("grey_btn").end().find(".b-time-block_defer-msg").addClass("g-hidden").end().find(".b-time-block__defer-btn").addClass("g-hidden"),K.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden").end().find(".b-time-block_defer-msg").addClass("g-hidden").end().find(".b-time-block__defer-btn").addClass("g-hidden").end().find('[data-deferred="empty"]').removeClass("g-hidden"),W.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden"),H.find(".slot_time.not_active").hasClass("active")||H.find('[data-button="time_slot_ok"]').removeClass("grey_btn g-hidden"),H.find(".slot_time.active").length||H.find('[data-button="time_slot_ok"]').addClass("g-hidden")):(H.find('[data-button="time_slot_ok"]').removeClass("grey_btn").end().find(".b-time-block_defer-msg").addClass("g-hidden").end().find(".b-time-block__defer-btn").addClass("g-hidden"),K.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden").end().find(".b-time-block_defer-msg").addClass("g-hidden").end().find(".b-time-block__defer-btn").addClass("g-hidden").end().find('[data-deferred="empty"]').removeClass("g-hidden"),W.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden"),H.find(".slot_time.not_active").hasClass("active")||H.find('[data-button="time_slot_ok"]').removeClass("grey_btn g-hidden"),H.find(".slot_time.active").length||H.find('[data-button="time_slot_ok"]').addClass("g-hidden")),updateRecommendationsHash(),flocktoryBasketPrice(t.price_cart_total_amount)}})}function update_block_deferred(e,t,a){ajax_modify_count_item_cart=!0,$.ajax({url:"/udata/avemarket/lists/deferred/"+a+"/"+e+"/"+t,type:"POST",dataType:"json",success:function(e){ajax_modify_count_item_cart=!1;var t=e.total_price_first,r=e.total_price_last,i=e.total_amount;i=parseInt(i);var n=e.post_fix_amount;0==i?$(".avemarket_cart").html('<i class="icon_cart"></i><span class="amount_cart">Корзина<br></span><span class="p"><span class="price_cart">пуста</span></span><span class="header_basket_popup_msg anim_ease"><i class="icon_add_to_cart"></i> <span class="fs12 middle">Товар добавлен в корзину</span></span>'):($(".amount_cart").text(i+" "+n),$(".price_cart").html(r?t+'<span class="price_postfix fs11">'+r+"</span>":t),"put"==a&&show_success_cart_notififcation(),"del"==a&&update_deffered_block_visual()),updateRecommendationsHash()},complete:function(){updateRecommendationsHash()}})}function update_block_item(e,t){if("table"==$.cookie("mode_list_goods"))var a=e.parents(".category_page_catalog_item_plate");else var a=e.parents(".category_page_table_catalog_item");t?(e.html('<i class="icon_add_to_cart"></i>Изменить'),a.find(".table_item_add_to_cart_span").removeClass("hidden").find(".amount").html(t)):(e.html('<i class="icon_add_to_cart"></i>В корзину'),a.find(".table_item_add_to_cart_span").addClass("hidden").find("span.amount").html(" "))}function updateRecommendationsHash(){return $("#recommendations").length||$("#recommendations-order").length?($.ajax({type:"POST",url:"/udata/catalog/getRecommendationsInBasketHash"}).done(function(e){var t=$(e).find("udata").text();global_recommendations_hash!==t&&$("#recommendations").length>0&&(global_recommendations_hash=t,updateRecommendationsBasket()),global_recommendations_hash!==t&&$("#recommendations-order").length>0&&(global_recommendations_hash=t,updateRecommendationsSuccessful())}),!1):!1}function updateRecommendationsBasket(){var e=$("#recommendations");return $.ajax({type:"GET",url:"/udata/catalog/getRecommendations/",data:{transform:"modules/avemarket/recommendations.xsl"}}).done(function(t){var a=$(t).find(".slider_wrapper");a.find(".recommendations-items-block").length?(e.removeClass("hidden display_none"),e.find(".slider_wrapper").html(a.html()),e.find(".slider-nav-prev").addClass("disabled"),e.find(".slider-nav-next").removeClass("disabled"),a.find(".recommendations-items-block").length>1?e.find(".slider-nav").removeClass("hidden"):e.find(".slider-nav").addClass("hidden"),page_cart_manipulations()):e.find(".slider_wrapper").html("").end().addClass("hidden")}),!1}function updateRecommendationsSuccessful(){return $.ajax({type:"GET",url:"/udata/catalog/getRecommendations/",data:{transform:"modules/avemarket/successful.xsl"}}).done(function(e){var t=$(e).find(".slider_wrapper"),a=$("#recommendations-order");t.find(".category_page_catalog_item_plate").length?(a.removeClass("hidden"),a.find(".slider_wrapper").html(t.html()),a.find(".slider_wrapper").css("left","0px"),a.find(".slider_frame").attr("data-current_offset","0"),a.find(".slider_ctrl.left").attr("disabled","disabled"),a.find(".slider_ctrl.right").removeAttr("disabled"),t.find(".category_page_catalog_item_plate").length>4?a.find(".slider_ctrl").removeClass("hidden"):a.find(".slider_ctrl").addClass("hidden"),page_cart_manipulations()):a.find(".slider_wrapper").html("").end().addClass("hidden")}),!1}function initRecommendationsBasket(){if(!$("#recommendations").length)return!1;var e=$("#recommendations");e.on("click",".slider-nav-next",function(){var t,a,r=$(this),i=e.find(".slider-nav-prev");return r.hasClass("disabled")?!1:(t=e.find(".recommendations-items-block").not(".hidden"),a=t.next(".recommendations-items-block"),t.addClass("hidden"),a.removeClass("hidden"),i.removeClass("disabled"),a.nextAll(".recommendations-items-block").length||r.addClass("disabled"),!1)}),e.on("click",".slider-nav-prev",function(){var t,a,r=$(this),i=e.find(".slider-nav-next");return r.hasClass("disabled")?!1:(t=e.find(".recommendations-items-block").not(".hidden"),a=t.prev(".recommendations-items-block"),t.addClass("hidden"),a.removeClass("hidden"),i.removeClass("disabled"),a.prevAll(".recommendations-items-block").length||r.addClass("disabled"),!1)})}function flocktoryBasketPrice(e){return e!==global_basket_total_price&&(window.flocktory=window.flocktory||[],window.flocktory.push(["price",e]),global_basket_total_price=e),!0}function getBasketPrice(){return $.ajax({url:"/udata/avemarket/getShortBasket/.json",type:"POST",dataType:"json",async:!1,success:function(e){return flocktoryBasketPrice(e.price_cart_total_amount),!0}}),!1}function inputVerification(e,t,a,r){var i=/^\d+$/gi,n=e.val();if(i.test(n)||e.val("1"),n>t&&e.val(t),"thing"==a&&1>n&&(e.val(1),$("div[id$="+r+"]").find(".cart_count_decrement").addClass("grey_btn")),"kg"==a&&1>n&&e.val(0),"gram"==a&&50>n){var o=e.parents(".gramm_input").siblings(".kg_input").find("input");0==o.val()&&e.val("050")}return!1}function inputWeightKgBlur(e){var t=15,a="kg";if(inputVerification(e,t,a),e.parents(".cart_table_item_cart").length>0){var r=e.parents(".cart_table_item_cart").attr("id").replace(/^count_/,"");actualItemPriceWeight(e)}else{var r=e.parents(".product_card_cartlabel_bottom_block").attr("id").replace(/^count_/,""),i=$("div[id$="+r+"]").find('input[type="number"][name="weight_kg"]').val(),n=$("div[id$="+r+"]").find('input[type="number"][name="weight_gram"]');inputWeightGramBlur(n);{i+"."+n.val()}}}function inputWeightGramBlur(e){var t,a=999,r="gram",i=e.val();switch(i.length){case 0:t="000";break;case 1:t="00"+i;break;case 2:t="0"+i}if(t&&e.val(t),inputVerification(e,a,r),e.parents(".cart_table_item_cart").length>0){var n=e.parents(".cart_table_item_cart").attr("id").replace(/^count_/,"");actualItemPriceWeight(e)}else{var n=e.parents(".product_card_cartlabel_bottom_block").attr("id").replace(/^count_/,"");$("div[id$="+n+"]").find('input[type="number"][name="weight_kg"]').val(),$("div[id$="+n+"]").find('input[type="number"][name="weight_gram"]').val()}}function actualItemPriceWeight(e){var t=e.parents(".cart_table_item_cart").find('input[name^="weight_kg"],input[name^="weight_gram"]'),a=t[0].value+"."+t[1].value;actualItemPrice(e,a)}function show_loader_1(){$(".background_overlay, .loader_1").show();var e=Math.round($(window).height()/2);$(".loader_1").css("top",e)}function show_loader_2(){$(".loader_2").show();var e=Math.round($(window).height()/2);$(".loader_2").css("top",$(window).scrollTop()+e/2);var t=$(".background_overlay:hidden").length;0==t&&$(".background_overlay").addClass("gif_loader"),t>0&&$(".background_overlay").show()}function hide_loader_1(){$(".background_overlay, .loader_1").hide()}function hide_loader_2(){$(".loader_2").hide(),$(".background_overlay").hasClass("gif_loader")?$(".background_overlay").removeClass("gif_loader"):$(".background_overlay").hide()}function cartUserAdd(e,t){register[e]=t}function verificationQuantity(e,t,a){var r=Number($("div[id$="+e+"]").find(".small_quantity").attr("data-quantity"));if($("div[id$="+e+"]").find(".small_quantity").removeClass("display_block").addClass("display_none"),$("div[id$="+e+"]").find(".small_quantity_in_cart").removeClass("display_block").addClass("display_none"),$("div[id$="+e+"]").find(".cart_count_increment").removeClass("grey-btn"),Number(t)>r&&!a){if($("div[id$="+e+"]").find('input[name="weight_thing"]').length>0)$("div[id$="+e+"]").find('input[name="weight_thing"]').val(r);else{var i=$("div[id$="+e+"]").find(".small_quantity").attr("data-kg");$("div[id$="+e+"]").find('input[name="weight_kg"]').val(i);var n=$("div[id$="+e+"]").find(".small_quantity").attr("data-gram");$("div[id$="+e+"]").find('input[name="weight_gram"]').val(n)}ga("send",{hitType:"event",eventCategory:"alert_dd",eventAction:"show",eventLabel:"incatagory"}),$("div[id$="+e+"]").find(".small_quantity").removeClass("display_none").addClass("display_block"),$("div[id$="+e+"]").find(".cart_count_increment").addClass("grey_btn")}else Number(t)<r&&a?($("div[id$="+e+"]").find(".small_quantity").removeClass("display_block").addClass("display_none"),$("div[id$="+e+"]").find(".cart_count_increment").removeClass("grey_btn")):Number(t)>r&&a&&(ga("send",{hitType:"event",eventCategory:"alert_dd",eventAction:"show",eventLabel:"incatagory"}),$("div[id$="+e+"]").find(".small_quantity").removeClass("display_none").addClass("display_block"));return!1}function chemMogu(){if(!$("ul.chemmogu").length)return!1;var e={chemMoguItemsActive:"",chemMoguItemsLinkActive:"",chemMoguDescriptionBottomBlockActive:"",dellItemActive:function(){return e.chemMoguItemsLinkActive.removeClass("active"),e.chemMoguItemsActive="",e.chemMoguItemsLinkActive="",e.chemMoguDescriptionBottomBlockActive="",!1},closeDescriptionBottomBlock:function(){return e.chemMoguDescriptionBottomBlockActive.slideUp(),e.dellItemActive(),history.pushState?history.pushState(null,null,"#"):location.hash="#",!1},clickAnons:function(){var t=$(this);if(t.hasClass("active"))return!1;t.addClass("active");var a=t.siblings(".chemmogu_description").html(),r=t.closest(".chemmogu_item").nextAll(".chemmogu_description_bottom_block").eq(0);e.chemMoguDescriptionBottomBlockActive?r.html()==e.chemMoguDescriptionBottomBlockActive.html()?(e.chemMoguItemsLinkActive&&e.chemMoguItemsLinkActive.removeClass("active"),r.fadeOut("slow",function(){r.html(a).fadeIn("slow"),e.chemMoguItemsLinkActive=t})):(e.chemMoguItemsLinkActive&&e.chemMoguItemsLinkActive.removeClass("active"),e.chemMoguDescriptionBottomBlockActive.stop(!0,!0).slideUp(),e.chemMoguDescriptionBottomBlockActive.slideUp("slow",function(){r.html(a).slideDown("slow",function(){e.chemMoguDescriptionBottomBlockActive.stop(!0,!0).slideUp(),r.html(a).fadeIn("slow").addClass("active"),e.chemMoguDescriptionBottomBlockActive=r,e.chemMoguItemsLinkActive=t})})):(e.chemMoguDescriptionBottomBlockActive=r,r.slideUp("slow",function(){r.html(a).slideDown().addClass("active"),e.chemMoguItemsLinkActive=t})),$("html, body").animate({scrollTop:$(".chemmogu_anons.active").offset().top-325},800)},checkItemActive:function(){var e=window.location.hash;if(!e||"#"==e)return!1;var t=$('.chemmogu_item a[href="'+e+'"]');return t.click(),!1},eventFunction:function(){return $("li.chemmogu_item .chemmogu_anons").on("click",e.clickAnons),$(".chemmogu_description_bottom_block").delegate(".icon_gray_close","click",e.closeDescriptionBottomBlock),!1}};e.eventFunction(),e.checkItemActive()}function update_cart_block_visual(){$.ajax({url:"/udata/avemarket/cart/extract_booth/",type:"GET",async:!1,global:!1,data:{transform:"modules/avemarket/cart_items.xsl"},dataType:"html",success:function(e){$(".cart_empty_message.cart").hasClass("display_none")||$(".cart_empty_message.cart").addClass("display_none"),$(".blocks_elements_items_dishes").html(e),hideSorryNoItems(),page_cart_manipulations(),controlOrderingButtons()}})}function update_deferred_block_visual(){$.ajax({url:"/udata/avemarket/products_list/deferred",type:"GET",global:!1,async:!1,data:{transform:"modules/avemarket/deferred_items.xsl"},dataType:"html",success:function(e){$(".cart_empty_message.deferred").hasClass("display_none")||$(".cart_empty_message.deferred").addClass("display_none"),$(".cart_watch_later_items_block").not(".recommendations-items").html(e),$(".cart_watch_later_items_block").not(".recommendations-items").hasClass("display_none")&&$(".cart_watch_later_items_block").not(".recommendations-items").removeClass("display_none"),page_cart_manipulations()}})}function hideReservRedMessage(){setTimeout(function(){$("div#cart_red_message_div").animate({height:"0",display:"none"},500),$("div#cart_red_message_div + .clear.red").animate({height:"0",display:"none"},200)},500)}function showReservRedMessage(){setTimeout(function(){$("div#cart_red_message_div").animate({height:"66"},500),$("div#cart_red_message_div + .clear.red").animate({height:"20"},200)},500)}function hideReservGreenMessage(){setTimeout(function(){$("div#cart_notify_clock_div").animate({height:"0"},500),$("div#cart_notify_clock_div + .clear.green").animate({height:"0"},200)},500)}function showReservGreenMessage(){var e=$("div#cart_notify_clock_div").height();(e="0")&&setTimeout(function(){$("div#cart_notify_clock_div").animate({height:"122"},500),$("div#cart_notify_clock_div + .clear.green").animate({height:"20"},200)
},500)}function setSelectedTimeEmpty(){if($("div").is("#time_delivery")){var e=$("#time_delivery");e.html('<span style="color: #da1f3e;">Не указано время</span>'),e.removeAttr("time"),$(".js_link.time_slot_up").removeClass("b-window__time-text").html("<span>Свободные часы</span> <span>доставки</span>"),$("#float_time_or_link").html('<a href="/personal/delivery_products/" class="link_header_color_green">Условия доставки</a>').removeClass("g-hidden")}}function controlOrderingButtons(){var e=(!$(".min_cash_shipping:visible").length>0,$(".cart_table_item").length>0),t=$("#address_delivery").attr("address"),a=$("#time_delivery").attr("time");items_exists_befor_order=$(".user_account_personal_data_subscriptions_item").length>0,e&&t&&a?$("#purchasing").removeClass("grey_btn"):$("#purchasing").addClass("grey_btn"),t||($("#address_delivery").html('<span style="color: #da1f3e;">Не указан адрес</span>'),$(".documents_verification__energo").addClass("g-hidden")),a||$("#time_delivery").html('<span style="color: #da1f3e;">Не указано время</span>'),items_exists_befor_order&&t&&a?$("#successful_two").removeClass("grey_btn"):$("#successful_two").addClass("grey_btn")}function page_cart_manipulations(){function e(e){if(ajax_modify_count_item_cart=!0,$(e).hasClass("grey_btn"))return!1;var t=$(e).attr("id").replace(/^count_increment_/,""),a=$("#cart_table_item_"+t),r=a.attr("name"),i=a.attr("item_type"),n=a.attr("category_name"),o=a.attr("price"),s=(a.attr("original_price"),$("#count_value_"+t)),d=s.attr("amount_basket");clearInterval(intervalEditItemInCart[t]);var c=parseInt(s.val()),l=99;c++,s.val(c);var _=$("#count_value_"+t);return inputVerification(_,l),c>1&&$(e).siblings(".cart_count_decrement").removeClass("grey_btn"),c>98&&$(e).addClass("grey_btn"),100>c&&($(e).hasClass("basket")?intervalEditItemInCart[t]=setInterval(function(){update_block_cart(t,c,"put");var e={name:r,id:t,price:o,category:n,quantity:c-d,type:i};$(document).trigger("products-add-to-cart",e),s.attr("amount_basket",c),clearInterval(intervalEditItemInCart[t])},1e3):verificationQuantity(t,c),$(e).hasClass("deferred")&&update_block_deferred(t,c,"put")),!1}function t(e){if($(e).hasClass("grey_btn"))return!1;var t=($(e).attr("id"),$(e).attr("id").replace(/^dynamic_count_increment_/,"")),a=$("#count_value_"+t),r=parseInt(a.val());$("#dynamic_count_value_"+t).val(r);$("#dynamic_count_value_"+t);return r>1&&$(e).siblings(".cart_count_decrement").removeClass("grey_btn"),r>98&&$(e).addClass("grey_btn"),!1}function a(e){ajax_modify_count_item_cart=!0;var t=e.attr("id").replace(/^count_decrement_/,""),a=$("#cart_table_item_"+t),r=a.attr("name"),i=a.attr("item_type"),n=a.attr("category_name"),o=a.attr("price"),s=(a.attr("original_price"),$("#count_value_"+t)),d=s.attr("amount_basket"),c=parseInt(s.val());return 2>c?void 0:(clearInterval(intervalEditItemInCart[t]),c>1&&(c--,s.val(c),99>c&&e.siblings(".cart_count_increment").removeClass("grey_btn"),e.hasClass("basket")?intervalEditItemInCart[t]=setInterval(function(){update_block_cart(t,c,"put");var e={name:r,id:t,price:o,category:n,quantity:d-c,type:i};$(document).trigger("products-remove-from-cart",e),s.attr("amount_basket",c),clearInterval(intervalEditItemInCart[t])},1e3):verificationQuantity(t,c),e.hasClass("deferred")&&update_block_deferred(t,c,"put")),2>c&&e.addClass("grey_btn"),!1)}function r(e){var t=e.attr("id").replace(/^dynamic_count_decrement_/,""),a=$("#dynamic_count_value_"+t),r=parseInt(a.val());return r>1&&(r--,a.val(r),99>r&&e.siblings(".cart_count_increment").removeClass("grey_btn"),e.hasClass("deferred")&&update_block_deferred(t,r,"put")),2>r&&e.addClass("grey_btn"),!1}$(".dynamic_div_remove").off().click(function(){for(var e in $(".sorry-no .cart_table_item")){if(e=$(".sorry-no .cart_table_item")[e],!e)break;var t=$(e).attr("id").replace("dynamic_cart_table_item_","");update_block_cart(t,"","del"),$("#item_unavailable_"+t).fadeOut("slow"),$("#cart_table_item_"+t).fadeOut("slow"),$("#cart_table_item_"+t).remove(),$("#dynamic_item_unavailable_"+t).fadeOut("slow"),$("#dynamic_cart_table_item_"+t).fadeOut("slow"),$("#dynamic_cart_table_item_"+t).remove(),$(".sorry-no .cart_table_item").length||($(".sorry-no").fadeOut("slow"),$(".sorry-no").remove())}}),$(".div_remove").off().click(function(){$(".sorry-no [id^=item_unavailable_]").length&&$(".sorry-no [id^=item_unavailable_]").each(function(){var e=$(this),t=$(e).parent(),a=$(e).attr("id").replace("item_unavailable_","");update_block_cart(a,"","del"),$("#item_unavailable_"+a).fadeOut("slow"),$("#item_unavailable_"+a).remove(),$("#cart_table_item_"+a).fadeOut("slow"),$("#cart_table_item_"+a).remove(),t.fadeOut("slow"),t.remove()})}),$(".cart_table_item_remove").off("click").on("click",function(){if($(this).parents(".small_quantity").is("div"))var e=$(this).parents(".small_quantity").attr("data-id");else var e=$(this).attr("id").replace("item_remove_","").replace("dynamic_","");var t=$("#cart_table_item_"+e),a=t.attr("name"),r=t.attr("category_name"),i=t.attr("original_price"),n=t.attr("item_type"),o=$("#count_"+e),s=o.find(".cart_count_value_input"),d=o.find('input[name = "weight_kg"]').val(),c=o.find('input[name = "weight_gram"]').val();if(s.length)var l=parseFloat(s.val());else var l=parseFloat(d+"."+c);var _={name:a,id:e,price:i,category:r,quantity:l,type:n};return $(document).trigger("products-remove-from-cart",_),update_block_cart(e,"","del"),$("#item_unavailable_"+e).fadeOut("slow"),$("#cart_table_item_"+e).fadeOut("slow"),$("#cart_table_item_"+e).remove(),$("#dynamic_item_unavailable_"+e).fadeOut("slow"),$("#dynamic_cart_table_item_"+e).fadeOut("slow"),$("#dynamic_cart_table_item_"+e).remove(),$(".sorry-no .cart_table_item").length||($(".sorry-no").fadeOut("slow"),$(".sorry-no").remove()),update_cart_block_visual(),!1}),$(".add_favorites").off().click(function(){var e=$("#user_type").val();if("guest"==e)return show_form_aut(),!1;var t=$(this),a=t.attr("id").replace(/^favorit_/,"");return $.ajax({url:"/udata/avemarket/favorites_add/"+a+"/",type:"POST",dataType:"xml",success:function(e){var a=$(e).find("udata").text();if("OK"==a){var r=t.find("i");if(r.length)if(r.hasClass("icon_tofavourite"))r.removeClass("icon_tofavourite").addClass("icon_star_active");else if(r.removeClass("icon_star_active").addClass("icon_tofavourite"),$("a.item_my_lists.current")){var i=$("a.item_my_lists.current").attr("href").replace("?number=","");"favorites"==i&&$(t).parents(".category_page_catalog_item_plate").fadeOut("slow")}}}}),!1}),$(".product_card_header_functions_item a.table_item_lists_dropdown").off().click(function(){var e=$("#user_type").val();return"guest"==e?(show_form_aut(),!1):!0}),checkDynamic=function(e){var t=$("#cart_table_item_"+e+" .buy_available").attr("data-val");if($("#count_value_"+e).length)var a=$("#count_value_"+e).val();else a=parseFloat($("#dynamic_weight_kg_"+e).val()+"."+$("#dynamic_weight_gram_"+e).val());var r=$(".sorry-no .cart_table_item").length;t-a>=0&&($("#dynamic_cart_table_item_"+e).slideUp("slow",function(){$("#dynamic_cart_table_item_"+e+" input[id^=dynamic_]").each(function(e,t){try{var a=$(t).attr("id").replace("dynamic_","");$("#"+a).val($(t).val())}catch(r){}}),$("#dynamic_cart_table_item_"+e).remove(),$("#cart_table_item_"+e).fadeIn("slow")}),r--,r||$(".sorry-no").slideUp("slow",function(){$(".sorry-no").remove()}))},$(".cart_count_increment").off().click(function(){var a=$(this).attr("id").replace("count_increment_","").replace("dynamic_","");return e($("#count_increment_"+a)),$("#dynamic_count_increment_"+a).length&&(t($("#dynamic_count_increment_"+a)),checkDynamic(a)),!1}),$(".cart_count_decrement").off().click(function(){var e=$(this).attr("id").replace("count_decrement_","").replace("dynamic_","");return a($("#count_decrement_"+e)),$("#dynamic_count_increment_"+e).length&&(r($("#dynamic_count_decrement_"+e)),checkDynamic(e)),!1}),$(".cart_count_value_input").off().change(function(){ajax_modify_count_item_cart=!0;var e=$(this);e.val().length>2&&e.val(e.val().substr(0,2));var t=$(this).attr("id").replace("count_value_","").replace("dynamic_",""),a=$("#cart_table_item_"+t),r=a.attr("name"),i=a.attr("item_type"),n=a.attr("category_name"),o=a.attr("price"),s=(a.attr("original_price"),parseInt($(this).val())),d=$(this).attr("amount_basket"),c={basket:"#count_value_"+t,dynamic:"#dynamic_count_value_"+t};if($(this).hasClass("basket")){update_block_cart(t,s,"put");var l={name:r,id:t,price:o,category:n,type:i};s-d>0&&(l.quantity=s-d,$(document).trigger("products-add-to-cart",l)),0>s-d&&(l.quantity=d-s,$(document).trigger("products-remove-from-cart",l)),$(this).attr("amount_basket",s)}return $(this).hasClass("deferred")&&update_block_deferred(t,s,"put"),1>s&&(s=1),$(c.basket).val(s),$(c.dynamic).val(s),checkDynamic(t),!1}),$(".weight_kg").off().change(function(){inputWeightKgBlur($(this));var e=$(this).attr("id").replace(/^weight_kg_/,""),t=$("#cart_table_item_"+e),a=t.attr("name"),r=t.attr("item_type"),i=t.attr("category_name"),n=t.attr("original_price"),o=1*$(this).val(),s=1*$(this).attr("amount_basket"),d=$("#weight_gram_"+e).val()/1e3,c=$("#weight_gram_"+e).attr("amount_basket")/1e3,l=parseFloat(o+d),_=parseFloat(s+c),u={name:a,id:e,price:n,category:i,type:r};return l-_>0&&(u.quantity=l-_,$(document).trigger("products-add-to-cart",u)),0>l-_&&(u.quantity=_-l,$(document).trigger("products-remove-from-cart",u)),$(this).attr("amount_basket",o),update_block_cart(e,l,"put"),!1}),$(".weight_gram").off().change(function(){inputWeightGramBlur($(this));var e=$(this).attr("id").replace(/^weight_gram_/,""),t=$("#cart_table_item_"+e),a=t.attr("name"),r=t.attr("item_type"),i=t.attr("category_name"),n=t.attr("price"),o=(t.attr("original_price"),$(this).val()/1e3),s=$(this).attr("amount_basket")/1e3,d=1*$("#weight_kg_"+e).val(),c=1*$("#weight_kg_"+e).attr("amount_basket"),l=parseFloat(d+o),_=parseFloat(c+s),u={name:a,id:e,price:n,category:i,type:r};return l-_>0&&(u.quantity=l-_,$(document).trigger("products-add-to-cart",u)),0>l-_&&(u.quantity=_-l,$(document).trigger("products-remove-from-cart",u)),$(this).attr("amount_basket",parseFloat(o)),update_block_cart(e,l,"put"),!1}),$(".sorry-no .weight_kg, .sorry-no .weight_gram").off().keyup(function(){var e=$(this);try{var t=$(this).attr("id").replace("dynamic_weight_kg_","")}catch(a){try{var t=$(this).attr("id").replace("dynamic_weight_gram_","")}catch(a){}}var r=e.parent().parent().parent().parent().parent(),i=parseInt($(r).find(".gramm_input input").val());if(i>1e3){var n=Math.ceil(i/1e3);i%=1e3}else var n=$(r).find(".kg_input input").val();var o=parseFloat(n+"."+i);return $(this).hasClass("basket")&&update_block_cart(t,o,"put"),1>o&&(o=1),checkDynamic(t),!0}),$(".add_new_list").off().click(function(){var e=$(this).attr("id").replace(/^add_new_list_for_/,""),t=$(this).parent().parent().find('input[name="new_list"]').val();return t?($.ajax({url:"/udata/avemarket/add_new_list/"+t,type:"POST",data:{},dataType:"xml",success:function(a){var r=$(a).find("udata").text();r&&($(".list_block.wholecart").append('<p class="fs13"><a class="item_list wholecart" id="item_wholecart_'+r+'">'+t+"</a></p>"),$(".list_block.singleitem").append('<p class="fs13"><a class="item_list singleitem" id="item_'+e+"_"+r+'">'+t+"</a></p>"),$('input[name="new_list"]').val(""),page_cart_manipulations())}}),!1):!1})}function available_item(){$("#global_basket_update").on("click",".buy_available",function(){var e=$(this).parents(".small_quantity").attr("data-id"),t="#cart_table_item_"+e;t+=",#dynamic_cart_table_item_"+e;var a=$("#cart_table_item_"+e),r=a.attr("name"),i=a.attr("item_type"),n=a.attr("category_name"),o=a.attr("original_price"),s=$("#count_value_"+e).attr("amount_basket")||0,d=$(this).attr("data-val");if($(this).hasClass("kg")){var c=$(this).attr("data-kg"),l=$(this).attr("data-gr");$(t).find('input[name="weight_kg"]').val(c),$(t).find('input[name="weight_gram"]').val(l),s=1*a.find('input[name="weight_kg"]').attr("amount_basket")+a.find('input[name="weight_gram"]').attr("amount_basket")/1e3}else $(t).find('input[type="number"]').val(d);$(this).parents(".small_quantity").removeClass("display_block").addClass("display_none");var _={name:r,id:e,price:o,category:n,type:i};d-s>0&&(_.quantity=d-s,$(document).trigger("products-add-to-cart",_)),0>d-s&&(_.quantity=s-d,$(document).trigger("products-remove-from-cart",_)),$(this).hasClass("kg")?(a.find('input[name="weight_kg"]').attr("amount_basket",c),a.find('input[name="weight_gram"]').attr("amount_basket",l)):$("#count_value_"+e).attr("amount_basket",d),update_block_cart(e,d,"put"),checkDynamic(e)})}function available_items(e){return $.ajax({url:"/udata/avemarket/get_available_items/"+e,type:"POST",data:{dataType:"xml"},success:function(t){var a=".cart_active_elements_block #cart_table_item_"+e;if($(a)){var r=$(t).find("item");if(r){var i=$(r).attr("available"),n=$(r).attr("deficit"),o=$(r).attr("metric"),s=$(r).attr("quantity"),d=$(r).attr("quantity_kg"),c=$(r).attr("quantity_gr"),l=$(r).attr("category_link"),_="";0==i&&n>0?(_=0==s?"В данное время товара нет":"0"!=d||"000"!=c?"Выбранного вами товара осталось "+s+" "+o+' <span class="buy_available kg" data-val="'+s+'" data-kg="'+d+'" data-gr="'+c+'" >Хотите приобрести '+s+" "+o+'</span> или <a href="'+l+'">выберете замену</a> ?':"Выбранного вами товара осталось "+s+" "+o+' <span class="buy_available" data-val="'+s+'">Хотите приобрести '+s+" "+o+'</span> или <a href="'+l+'">выберете замену</a> ?',ga("send",{hitType:"event",eventCategory:"alert_dd",eventAction:"show",eventLabel:"incart"}),$(a).find(".small_quantity").removeClass("display_none").addClass("display_block").html(_),available_item()):$(a).find(".small_quantity").removeClass("display_block").addClass("display_none").html()}}}}),!1}function actualItemPrice(e,t,a){if(arguments.length>3)var r=arguments[3];else var r=".cart_active_elements_block #count_"+e;if($(r)){var i=t,n=i.toString().split(".");$(r).find(".item_total_price").html(isNaN(n[0])?"0 ":addSpace(n[0])+" "),$(r).find(".price_postfix_total").html(void 0===n[1]?"00":n[1].length<2?n[1]+"0":n[1].slice(0,2))}if(a>0){$(r).find(".discount_cart").css({display:"block",color:"#da1f3e"}),$(r).find(".item_total_price").css("color","#da1f3e").siblings().css("color","#da1f3e");var o=a,s=o.toString().split(".");$(r).find(".item_discount").html(isNaN(s[0])?"0 ":addSpace(s[0])+" "),$(r).find(".postfix_discount").html(void 0===s[1]?"00":s[1].length<2?s[1]+"0":s[1].slice(0,2))}else $(r).find(".discount_cart").css("display","none"),$(r).find(".item_total_price").css("color","black").siblings().css("color","black");return!1}function collection_personal_data(){var e=[],t=$("#registration_form");e.login=t.find('input[name = "login"]').val(),e.password=t.find('input[name = "password"]').val(),e.password_confirm=t.find('input[name = "password_confirm"]').val(),e.fname=t.find('input[name = "data[new][fname]"]').val(),e.phone=t.find('input[name = "phone"]').val(),e.type_card=t.find('input[name = "personal_card_type"]').val(),e.number_card=t.find('input[name = "personal_user_card_number"]').val(),e.card_img_id=t.find('input[name = "personal_card_type"]').attr("card_img_id"),e.day=$("div.day>ul>li.selected").text(),e.data={"new":{fname:e.fname,screen_name:e.fname,phone:e.phone}},e.spam_allowed=t.find('input[name="spam_allowed"]').next("span").hasClass("checked"),e.social_name=t.find('input[name = "social_name"]').val(),e.uid=t.find('input[name = "uid"]').val();var a=t.find("div.month li"),r=0;return a.each(function(){return $(this).hasClass("selected")?(e.month=r,!1):void r++}),e}function collection_address_data(){var e={},t=$("#form_add_address_user");return e.full_str_address=t.find('textarea[name = "full_str_address"]').val(),e.address_details=t.find('input[name = "address_details"]').val(),e.private_house=1*t.find('input[name="private_house"][type="checkbox"]').is(":checked"),e.phone=t.find('input[name = "phone"]').val(),e.comment=t.find('textarea[name = "comment"]').val(),e.coordinates=t.find('input[name = "str_point"]').val(),e.area_id=t.find('input[name = "area_search_id"]').val(),e.addr_id=t.find('input[name = "addr_id"]').val(),e.receive_correspondence=t.find('input[name="correspondence"]').next(".checkbox").hasClass("checked"),e.default_delivery=t.find('input[name="default_delivery"]').next(".checkbox").hasClass("checked"),e.administrativeArea=t.find('input[name = "AdministrativeArea"]').val(),e.subAdministrativeArea=t.find('input[name = "SubAdministrativeArea"]').val(),e}function collection_notification_data(){var e=Array(),t=0,a=$(".user_account_personal_data_subscriptions");return a.find(".user_account_personal_data_subscriptions_item").each(function(){e[t]={};var a=$(this).attr("id");e[t].id=a,$(this).find("input").each(function(){var a=$(this).attr("name"),r=$(this).next("span").hasClass("checked");e[t][a]=1*r}),t++}),e}function collection_personal_edit_data(){var e={},t=$("form.user_account_personal_data_form");e.name=t.find('input[name="fname"]').val(),e.email=t.find('input[name="email"]').val(),e.phone=t.find('input[name="phone"]').val(),e.spam_allowed=1*t.find('input[name="spam_allowed"][type="checkbox"]').is(":checked"),e.day=t.find("div.day li.selected").html(),e.general_notifications=1*t.find("input#spam_allowed").next("span").hasClass("checked");var a=t.find("div.month li"),r=0;return a.each(function(){return $(this).hasClass("selected")?(e.month=r,!1):void r++}),e}function collection_data_discount_card(e){var t=e.parent(),a={};return a.card_input_number=t.find('input[name = "user_card_number"]'),a.card_error=t.find(".fs13.error_message"),a.card_img_src=t.find("img").attr("src"),a.card_img_id=t.find("img").attr("card_img_id"),a.number_card=t.find('input[name = "user_card_number"]').val(),a.type_card=t.find('input[name = "type"]').val(),a}function check_address_details(e){var t;e||(e=$("#form_add_address_user")),$("#add_address_user").length&&(t=$("#add_address_user")),t||(t=$("#save_address_user"));var a=!1;return e.find(".required").each(function(){var e=$(this);if(!e.val()&&!e.attr("disabled")){e.addClass("error");var r=e.attr("name")+"_error";return $("div#"+r).show(),a=!0,t.addClass("grey_btn"),a}e.removeClass("error");var r=e.attr("name")+"_error";$("div#"+r).hide(),a||t.removeClass("grey_btn"),a=!1}),a}function upload_api_yandex_map(){function e(){var e=document.createElement("script");e.src="/templates/av/js/map_search.js";var t=document.getElementsByTagName("head")[0];t.appendChild(e),e.onload=e.onerror=function(){this.executed||(this.executed=!0)},e.onreadystatechange=function(){var e=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){e.onload()},0)}}var t=document.createElement("script");t.src="http://api-maps.yandex.ru/2.0/?load=package.full&amp;mode=release&amp;lang=ru-RU";var a=document.getElementsByTagName("head")[0];a.appendChild(t),t.onload=t.onerror=function(){this.executed||(this.executed=!0,e())},t.onreadystatechange=function(){var e=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){e.onload()},0)}}function getQueryParam(e){var e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function parseUrl(e){document.createElement("a");return a.href=e,a}function linkSearchGet(e){var t,a=$.cookie("available_to_order"),r=getQueryParam("osm");if(0!==document.location.pathname.indexOf("/search_page")){if("all_goods"!==a&&"1"!==r)return!1}else if("1"!==r)return!1;t=e?e.find("a"):document.getElementsByTagName("a"),$("form").append('<input type="hidden" name="osm" value="1"/>');for(var i=0;i<t.length;i++){var n=t[i];if(!n.className.match(/\bjs-ignore-osm\b/)){var o=linkAddGet(n.href,!0);n.href=o}}}function catalogListAnalitics(){var e={items:[],name:"Товары"};$(".js-catalog-list-item").each(function(t,a){var r=a.getAttribute("data-id");e.items.push({position:t+1,id:r})}),$(document).trigger("product-list-load",e),$(".js-catalog-list-item .js-catalog-prod-link").on("click",function(){var e=$(this),t=e.parents(".js-catalog-list-item"),a=t.find(".add_to_cart_btn"),r={id:t.data("id"),name:a.attr("name"),price:a.attr("price"),category:a.attr("category_name"),list:"Товары"};$(document).trigger("product-list-click",r)})}function recommendationsListAnalitics(){var e=$("#recommendations");e.on("click",".js-recommendations-prod-link",function(){var e=$(this),t=e.parents(".js-recommendations-list-item"),a=t.find(".add_to_cart_btn"),r={};r={id:t.data("id"),name:a.attr("name"),price:a.attr("original_price"),category:a.attr("category_name"),list:"Рекомендованные товары"},$(document).trigger("product-list-click",r)})}function linkAddGet(e,t){var a=e.replace("http://",""),r=a.split("/"),i=r.length-1;if("food"!=r[1]&&"alcohol"!=r[1]&&"nonfood"!=r[1]&&"search_page"!=r[1]&&"collections"!=r[1]&&"discount"!=r[1])return e;if("search_page"!=r[1]&&"discount"!=r[1]){if("all"==r[2])return e;if(2==i)return e}if(""!=r[i]){var n=r[i].replace("?","").replace("#","").replace("##",""),o=n.replace("&osm=1","").replace("osm=1&","").replace("osm=1","");r[i]=t?""!=o?"?"+o+"&osm=1":"?osm=1":""!=o?"?"+o:""}else t&&(r[i]="?osm=1");var s="http://"+r.join("/");return s}function ajax_replace_slider(e){var t=document.URL.split("/"),a=16;if(("food"==t[3]||"nonfood"==t[3])&&""==t[5]){if("special"==e)return window.ajax_slider.push({spec_name:e,upload:1}),$(document).trigger("data-layer-load"),!1;a=15}if(("food"==t[3]||"nonfood"==t[3])&&""!=t[5]){if("profitable"==e)return window.ajax_slider.push({spec_name:e,upload:1}),$(document).trigger("data-layer-load"),!1;a=15}var r=$("#div_ajax_slider_"+e),i=$(r).attr("document_id");return e&&i?($.ajax({url:"/udata/catalog/get_special_offer_items/"+i+"/"+e+"/"+a+"/",type:"GET",async:!0,global:!1,data:{auth:global_user_auth,transform:"modules/sliders_more_products/ajax_slider_more_product.xsl"},dataType:"html",success:function(t){var a=$(t).find("div .item_top_accent_block");if(a.length){r.css("display","block"),r.append(t),event_slider(r);var i={items:[],name:block_names[e]};return a.each(function(e,t){var a=t.getAttribute("data-id");i.items.push({position:e+1,id:a})}),$(document).trigger("product-list-load",i),r.find(".a_with_class").click(function(){var e=$(this).parent("div").find(".item_top_accent_block"),t=e.data("id"),a=e.data("name"),r=e.data("price"),n=e.data("category-name"),o={id:t,name:a,price:r,category:n,list:i.name};$(document).trigger("product-list-click",o)}),window.ajax_slider.push({spec_name:e,upload:1}),$(document).trigger("data-layer-load"),!0}window.ajax_slider.push({spec_name:e,upload:1}),$(document).trigger("data-layer-load"),r.remove()}}),!1):(window.ajax_slider.push({spec_name:e,upload:1}),$(document).trigger("data-layer-load"),!1)}function event_slider(e){var t=e.find(".slider_ctrl"),a=e,r=a.find(".slider_wrapper"),i=r.children().eq(0),n=i.width()+int(i.css("border-left-width"))+int(i.css("border-right-width"))+int(i.css("margin-left"))+int(i.css("margin-right")),o=Math.abs(Math.round(int(r.css("left"))/n));0==o&&t.filter(".left").attr("disabled","disabled"),t.click(function(){var e=$(this).closest(".slider_frame"),a=e.find(".slider_wrapper"),r=a.children().eq(0),i=r.width()+int(r.css("border-left-width"))+int(r.css("border-right-width"))+int(r.css("margin-left"))+int(r.css("margin-right")),n=Math.abs(Math.round(int(a.css("left"))/i)),o=Math.ceil(a.width()/i),s=Math.ceil(e.width()/i),d=o-s,c="+=",l=!0,_=e.attr("data-step_offset")?parseInt(e.attr("data-step_offset")):1;"undefined"==typeof e.attr("data-current_offset")&&e.attr("data-current_offset",n),t.removeAttr("disabled");var u=parseInt(e.attr("data-current_offset"));if($(this).hasClass("right")&&(c="-=",n>=d?l=!1:u+=_),$(this).hasClass("left")&&(0>=n?l=!1:u-=_),e.attr("data-from")&&!l){if("-="==c?u+=_:u-=_,0>u)return!1;var m=e.attr("data-from")+"?offset="+u;$.post(m,function(r){return $.trim(r)?("-="==c&&a.html(a.html()+r),l=!0,e.attr("data-current_offset",u),void a.animate({left:c+i*_},500)):(u-=_,e.attr("data-current_offset",u),t.filter(".right").attr("disabled","disabled"),!1)})}return 0==u&&t.filter(".left").attr("disabled","disabled"),u==d&&t.filter(".right").attr("disabled","disabled"),e.attr("data-current_offset",u),l?(a.animate({left:c+i*_},500),!1):!1}),$(".add_to_cart_btn").off().click(function(){var e=($("#user_type").val(),$(this).attr("id").replace(/^add_basket_/,"")),t=$(this).attr("category_id"),a=$(this).attr("name"),r=$(this).attr("item_type"),i=$(this).attr("original_price"),n=$(this).attr("price"),o=$(this).attr("category_name"),s=$(this).attr("amount_basket")||0,d=$("#count_"+e),c=d.find(".cart_count_value_input"),l=d.find('input[name = "weight_kg"]').val(),_=d.find('input[name = "weight_gram"]').val();if(c.length)var u=parseFloat(c.val());else var u=parseFloat(l+"."+_);verificationQuantity(e,u);var m=d.find(".cart_count_value_input"),p=d.find('input[name = "weight_kg"]').val(),f=d.find('input[name = "weight_gram"]').val();if(m.length)var h=parseFloat(m.val());else var h=parseFloat(p+"."+f);h!=u&&(u=h,$("div[id$="+e+"]").find(".small_quantity").removeClass("display_block").addClass("display_none"),$("div[id$="+e+"]").find(".small_quantity_in_cart").removeClass("display_none").addClass("display_block")),_gaq.push(["_trackEvent","Buying","AddToCart",o,n]);var v={name:a,id:e,price:n,category:o,quantity:u,type:r};return u-s>0&&(v.quantity=u-s,$(document).trigger("products-add-to-cart",v)),0>u-s&&(v.quantity=s-u,$(document).trigger("products-remove-from-cart",v)),$(this).attr("amount_basket",u),update_block_cart(e,u,"put"),update_block_item($(this),u),$("div").is(".cart_active_elements_block'")&&update_cart_block_visual(),$("div").is(".cart_watch_later_items_block")&&$("#deferred_table_item_"+e).remove()&&update_block_deferred(e,"","del"),"undefined"==typeof __GetI&&(__GetI=[]),function(){var a={type:"CART_ADD",user_id:$('input[name="user_type"]').attr("user_id"),site_id:"131",product_id:e,category_id:t,product_price:i};__GetI.push(a);var r="undefined"==typeof __GetI_domain?"px.adhigh.net":__GetI_domain;a.forward_tag=a.forward_tag||!1;var n=("https:"==document.location.protocol?"https://":"http://")+r+"/p.js",o=document.createElement("script");o.type="text/javascript",o.src=n,document.body.appendChild(o)}(),$.ajax({url:"/udata/avemarket/addToRecentlyList/"+e,type:"GET"}),!1}),page_cart_manipulations()}jQuery.fn.slider=function(){$(this).each(function(){var e=$(this).find(".slider_ctrl"),t=$(this),a=t.find(".slider_wrapper"),r=a.children().eq(0),i=r.width()+int(r.css("border-left-width"))+int(r.css("border-right-width"))+int(r.css("margin-left"))+int(r.css("margin-right")),n=Math.abs(Math.round(int(a.css("left"))/i));0==n&&e.filter(".left").attr("disabled","disabled"),e.click(function(){var t=$(this).closest(".slider_frame");if(t.hasClass("slider_frame_product"))return slider_product($(this),e,t),!1;var a=t.find(".slider_wrapper"),r=a.children().eq(0),i=r.width()+int(r.css("border-left-width"))+int(r.css("border-right-width"))+int(r.css("margin-left"))+int(r.css("margin-right")),n=Math.abs(Math.round(int(a.css("left"))/i)),o=Math.round(a.width()/i),s=Math.round(t.width()/i),d=o-s,c="+=",l=!0,_=t.attr("data-step_offset")?parseInt(t.attr("data-step_offset")):1;"undefined"==typeof t.attr("data-current_offset")&&t.attr("data-current_offset",n),e.removeAttr("disabled");var u=parseInt(t.attr("data-current_offset"));if($(this).hasClass("right")&&(c="-=",n>=d?l=!1:u+=_),$(this).hasClass("left")&&(0>=n?l=!1:u-=_),t.attr("data-from")&&!l){if("-="==c?u+=_:u-=_,0>u)return!1;var m=t.attr("data-from")+"?offset="+u;$.post(m,function(r){return $.trim(r)?("-="==c&&a.html(a.html()+r),l=!0,t.attr("data-current_offset",u),void a.animate({left:c+i*_},500)):(u-=_,t.attr("data-current_offset",u),e.filter(".right").attr("disabled","disabled"),!1)})}return 0==u&&e.filter(".left").attr("disabled","disabled"),u==d&&e.filter(".right").attr("disabled","disabled"),t.attr("data-current_offset",u),l?(a.animate({left:c+i*_},500),!1):!1}),a.find(".item_product_card_photo_min").click(function(){a.find(".active").removeClass("active"),$(this).addClass("active");var r=$(this).prevAll(".item_product_card_photo_min").length,n=t.find(".slider_wrapper_big");n.find(".active").removeClass("active"),n.children().eq(r).addClass("active");var o=Math.round(a.width()/i),s=o-1;return e.removeAttr("disabled"),t.attr("data-current_offset",r),0==r&&e.filter(".left").attr("disabled","disabled"),r==s&&e.filter(".right").attr("disabled","disabled"),r>2&&s-2>=r?a.animate({left:-i*(r-2)},500):3>r?a.animate({left:0},500):r>s-2&&a.animate({left:-i*(s-4)},500),!1})})},jQuery.fn.outerHTML=function(e){return e?this.before(e).remove():$("<p>").append(this.eq(0).clone()).html()};var Modernizr=function(){this.touch=!1};$(function(){function e(){$(".submenu_category_menu").each(function(){var e=$(this),t=e.offset().top,a=e.height(),r='<ul class="submenu_category_menu top" style="width: 145px;height: 130px"></ul>',i=[],n=0,o="";i.push($(r)),e.find("li").each(function(){{var e=$(this),o=e.offset().top+e.height()-t-n;e.find("a").text()}o>a-15&&(i.push($(r)),n+=o-e.height()),i[i.length-1].append(e.outerHTML())});for(var s in i)o+=$(i[s][0]).outerHTML();e.replaceWith(o)})}function t(){try{{var e=$(".submenu_categories_frame");e.jScrollPane({autoReinitialise:!0,autoReinitialiseDelay:200})}window.jsp_api=e.data("jsp");var t=$(".jspScrollable").jScrollPane({autoReinitialise:!0,autoReinitialiseDelay:200});t.bind("mousewheel",function(e,t){return jsp_api.scrollByX(-50*t),!1})}catch(a){}}function a(){var e=$(".submenu_categories_select_block.nowrap.open").offset().left-$(".submenu_categories_frame").offset().left+-1*parseInt($(".jspPane").css("left"));jsp_api.scrollTo(e,0)}function r(){var e=-1*($(".gradient_my_lists.deliveries_history_item.current").offset().left-$(".slider_frame").offset().left);e&&$(".slider_ctrl.left").removeAttr("disabled"),$(".slider_frame .slider_wrapper").animate({left:e})}var i=0;document.all&&!document.addEventListener&&(document.createElement("header"),document.createElement("nav"),document.createElement("section"),document.createElement("article"),document.createElement("aside"),document.createElement("footer"),document.createElement("hgroup"),$("body").addClass("lt-ie9"),$(".modal_window").addClass("ie_shadow"),$(".has-dropdown").hover(function(e){$(this).addClass("hover"),e.stopPropagation()},function(e){$(this).removeClass("hover"),e.stopPropagation()}),$("a:not([class])").addClass("link_lined"));var n=!1;!function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0)
}(navigator.userAgent||navigator.vendor||window.opera),$("body").addClass(n?"mobile":"desktop"),$(document).foundation(null,null,null,null,!0),$("#main_page_slider").on("orbit:ready",function(){main_page_silder_change()}),$("#main_page_slider").on("orbit:after-slide-change",function(){main_page_silder_change()}),$("#main_page_brands_slider").on("orbit:ready",function(){main_page_brands_silder_change()}),$("#main_page_brands_slider").on("orbit:after-slide-change",function(){main_page_brands_silder_change()}),$(".joyride-close-tip").click(function(){$(this).closest(".f-dropdown").removeClass("open").css("left","-99999px")}),$(".expand_search_block .link_dotted").click(function(){var e=$(this).closest(".expand_search_block");e.find(".search_submit_input").val($(this).text()).focus(),clearTimeout(i)}),$(".slider_frame:has(.slider_ctrl)").slider(),$("label .checkbox_label").click(function(){$(this).closest("label").find(".checkbox, .radio").click(),$(this).closest("label").find('input[type="checkbox"], input[type="radio"]').click()}),"undefined"!=typeof opera&&changeType($("input[type=number]"),"text"),$(".text h2").each(function(){var e=$(this).text();$(this).replaceWith('<div class="lihe_header mb20"><span>'+e+"</span></div>")}),$(".text").each(function(){var e=$(this).find(">p:first"),t=e.html();e.replaceWith('<p class="fs22 mb20">'+t+"</p>")});var o=$(".header_float_menu").height();if($(".header_float_menu").css({position:"absolute",right:"0",top:"50%","margin-top":-1*Math.round(o/2)-5+"px"}),$(".user_account_sections_toggle").click(function(){return $(".user_account_sections_wrapper_wrapper").toggleClass("hidden"),!1}),$(".user_account_registration_card_form .modal_window_close").click(function(){return $(".user_account_registration_card_form").hide(),!1}),e(),t(),0!=$(".submenu_categories_select_block.nowrap.open").size()&&a(),0!=$(".gradient_my_lists.deliveries_history_item.current").size()&&r(),$("[data-model]").each(function(){try{var e=$(this).data("model");window[e]($(this))}catch(t){console.log("Eror with model "+e),console.log(t)}}),$("body").hasClass("mobile")){var s=!1,d=function(){$(".slider_wrapper>.category_page_catalog_item_plate").removeClass("hover")},c=function(){s=setTimeout(function(){d(),$(document).unbind("click",c)},50)};$(".slider_wrapper>.category_page_catalog_item_plate").click(function(e){d(),$(this).addClass("hover"),$(document).bind("click",c),e.preventDefault()}),$(".item_plate_hidden").click(function(){clearTimeout(s)})}$(".my_lists_add_button").click(function(){$(".my_lists_add_form").toggle()}),$("#feedback_about_work a").on("click",function(){var e="О работе магазина: "+$(this).text();console.log(e),$('input[name="subject_mess"]').val(e),$("#feedback_form_theme").text(e)})});var toBool=function(e){var t=/^((false)|(0))$/;return!t.test(e)},dropdown_menu=function(e){var t=$("#"+e.data("dropdown")),a=e.data("placeholder")?e.data("placeholder"):"Выберите из списка",r=e.offsetParent(),i={x:r.left,y:r.top,h:e.height(),w:e.width()},n=!1;e.data("value")||e.attr("data-value",-1);var o=""!=e.attr("data-replace_label_text")?toBool(e.attr("data-replace_label_text")):!0,s=e.attr("data-attach_to")?e.attr("data-attach_to"):"right";e.add(t).wrapAll('<div style="position:relative;"></div>');var d=function(){c(),t.css({top:0,"min-width":i.w,"z-index":10}),t.css(s,0),t.slideDown("fast",function(){t.css({"overflow-y":"auto"})})},c=function(){$(".dropdown_menu").not(t).slideUp("fast")},l=function(){t.slideUp("fast",function(){t.css({"overflow-y":"auto"})})},_=function(t){if(t){var r=t.html(),i=-1!=t.data("value")?t.data("value"):-1;e.attr("data-value",i),o&&e.html(r+' <i class="icon_dropdown_arrow"></i>')}else e.attr("data-value",-1),o&&e.html('<span class="link_dotted">'+a+'</span> <i class="icon_dropdown_arrow"></i>')},u=function(){return n=setTimeout(function(){l(),$(document).unbind("click",u)},100),!1};e.click(function(){return e.focus(),!1}),e.focus(function(){return d(),$(document).bind("click",u),!1}),e.blur(u),t.find("a").click(function(){_($(this))})},count_input=function(e){var t=function(){var e=i.val();return e=e?parseInt(e):n,isNaN(e)&&(e=n),e},a=e.find(".cart_count_decrement"),r=e.find(".cart_count_increment"),i=e.find(".cart_count_value_input"),n=1,o=1e4,s=t(),d=function(e){return n>e&&(e=n),e>o&&(e=o),e};a.click(function(){return s=t(),s--,s=d(s),i.val(s),!1}),r.click(function(){return s=t(),s++,s=d(s),i.val(s),!1}),i.keyup(function(){i.val(d(t()))})},scrollable_tabs_list=function(e){var t=e.find(".item_my_lists").index(e.find(".item_my_lists.current")),a=e.find(".slider_ctrl"),r=e.find(".slider_frame"),i=r.find(".slider_wrapper"),n=e.find(".item_my_lists"),o=n.eq(0),s=o.width()+int(o.css("border-left-width"))+int(o.css("border-right-width"))+int(o.css("margin-left"))+int(o.css("margin-right")),d=Math.abs(Math.round(int(i.css("left"))/s)),c=(Math.round(i.width()/s),Math.round(r.width()/s));if(t+1>c+d){var l=(t-(c-1))*s*-1;i.css("left",l),a.filter(".left").removeAttr("disabled")}if(e.data("tabs")){var _=$("#"+e.data("tabs")).find(".tab");n.click(function(){n.removeClass("current"),$(this).addClass("current");var e=n.index(this);_.hide(),_.eq(e).show()})}},cart_fixed_wnd=function(e){var t=e.width(),a=e.height(),r=$(window).height(),i=e.offset().top,n=$("footer").height()+10,o=$(".cart_watch_later_items_block").height()+100,s=$(document).height()-n-r-o;e.width(t),e.parent().height(a);var d=function(){var t=$(window).scrollTop();if(t+r>i+a){var n=0;t>s&&(n=t-s),e.css({position:"fixed",bottom:n})}else e.css({position:"static"})},c=function(){r=$(window).height()};$(window).scroll(d),$(window).resize(c)},toggle_info=function(e){var t=$("#"+e.data("info")),a=e.height()/2;t.css({position:"absolute",top:a,right:0,"box-shadow":"0 0 20px #888",background:"#FFF","z-index":100,"min-width":350}),e.add(t).wrapAll('<span style="position:relative;"></span>');var r=function(e){return t.fadeIn("fast"),$(document).bind("click",i),e.stopPropagation(),!1},i=function(e){t.fadeOut("fast"),$(document).unbind("click",i),e.stopPropagation()};e.click(r)},jobs_page=function(e){var t=$("#"+e.data("jobslist")),a=e.find("[data-city][data-pid]");a.eq(0).addClass("active");var r=function(e){var r=$(e.target);r.hasClass("section_header_tab")||(r=r.parent());var i=r.data("pid"),n=r.data("city"),o="/udata/job/list_vacancies/"+i+"/"+n+"/?transform=modules/job/list_vacancies.xsl";return a.removeClass("active"),r.addClass("active"),t.load(o),!1};a.click(r)},last_youtube_videos=function(e){var t=e.data.items,a=4,r=0,i=$("#youtube_last_vids"),n="		<li>";n+="			",n+='        		<a href="{link}" target="_blank" class="link_pic_block al_left">',n+='         		<img src="{img}">',n+='        			<span class="link_noline">',n+="        				{title}",n+="      			</span>",n+="      		</a>",n+="    	</li>",$("#youtube_last_vids").empty();for(var o in t){var s=t[o].duration-60*Math.floor(t[o].duration/60);s=(s+100).toString().substr(1);var d=Math.floor(t[o].duration/60),c=d+":"+s;if(i.append(n.replace(/\{img\}/g,t[o].thumbnail.hqDefault).replace(/\{link\}/g,t[o].player["default"]).replace(/\{title\}/g,t[o].title).replace(/\{views\}/g,t[o].viewCount).replace(/\{autor\}/g,t[o].uploader).replace(/\{duration\}/g,c)),r++,a==r)break}};$(document).ready(function(){$(".gramm_input input").change(function(){var e=$(this).parent().parent().parent(),t=parseInt($(this).val()),a=0;return t>999&&(a=Math.floor(t/1e3),t%=1e3,$(this).val(t),e.find(".kg_input").find("input").val(a)),!1}),$(".window_open_target").click(function(){var e,t=660,a=400,r=$(window).outerWidth(),i=$(window).outerHeight(),n=r/2-t/2,o=i/2-a/2;return e=window.open($(this).attr("href"),"","location=no,width="+t+",height="+a+",left="+n+",top="+o),!1}),$(".window_close_target").click(function(){window.close()})}),$(function(){$("#get-guest-label").on("click",function(){var e=$(this);$.get(e.data("get-label-url")).done(function(t){var a='<div class="header_background"></div><div class="lihe_header mb10"><span>Код доступа для оператора</span></div><div class="mb5 fs28">'+$(t).text()+'</div><div class="mb5 fs17">Сообщите код оператору контакт-центра, и мы окажем Вам помощь.</div>';e.replaceWith("Ваш код: "+$(t).text()),show_window_agreement(a,"submit_big")})})}),$(window).on("load",function(){window.window_is_loaded=!0});var dialog_box_action=0,ajax_modify_count_item_cart=!1;$(document).ready(function(){$("#article_menu_main_icon_drop").click(function(){return $(this).hasClass("active")?($("#about .menu.main").animate({"margin-top":"-76px"},"fast"),$(this).removeClass("active"),!1):($("#about .menu.main").animate({"margin-top":"0px"},"fast"),$(this).addClass("active"),!1)}),$(function(){$(".radio-button").click(function(){$("#address_button").removeClass("grey_btn"),update_block_cart()}),$(".radio-button").is(":checked")&&$("#address_button").removeClass("grey_btn")}),add_product_car="",month=new Array,month["Январь"]=31,month["Февраль"]=29,month["Март"]=31,month["Апрель"]=30,month["Май"]=31,month["Июнь"]=30,month["Июль"]=31,month["Август"]=31,month["Сентябрь"]=30,month["Октябрь"]=31,month["Ноябрь"]=30,month["Декабрь"]=31,$("div.month ul li").click(function(){var e=month[$(this).text()],t=0;$("div.day ul li").each(function(){e>=t?$(this).show():($(this).hide(),$("div.day ul li[class='selected']").text()>e&&$("div.day ul li:first").click()),t++})}),$("#subscribe_form").submit(function(){return console.log("Request to /udata/ideas/lab_subscribe/"+$(this).find("input[type=email]").val()),$.ajax({url:"/udata/ideas/lab_subscribe/"+$(this).find("input[type=email]").val(),type:"POST",success:function(e){console.log(e);var t="",a=$(e).find("udata").attr("error"),r=$(e).find("udata").attr("ok"),i=$("#subscription_result");"undefined"!=typeof r&&r!==!1?(t=r,i.hasClass("error_msg")&&i.removeClass("error_msg"),i.addClass("success_msg")):"undefined"!=typeof a&&a!==!1&&(t=a,i.hasClass("success_msg")&&i.removeClass("success_msg"),i.addClass("error_msg")),$("#subscription_result").text(t)}}),!1}),jQuery("div.icon_agreement_conditions_window_close").click(function(){jQuery("#agreement_conditions").hide("slow")}),jQuery("a.link_agreement").click(function(){return jQuery("#agreement_conditions").toggle(250),setTimeout('jQuery(".user_account_registration_block #agreement_conditions_content").jScrollPane();',300),!1}),jQuery("div.b-promo-dec__close").click(function(){jQuery("#promo_dec_modal").hide("slow")}),jQuery("a.b-promo-dec__open").click(function(){return jQuery("#promo_dec_modal").toggle(250),setTimeout('jQuery(".b-promo-dec__contener").jScrollPane();',300),!1}),$("#address_button").on("click",function(){return $(this).hasClass("grey_btn")?!1:($(".background_overlay").hide(),void $("#choice_address_delivery").hide())}),$("input.dcard2").bind("keydown keyup change",function(){if((event.keyCode<48||event.keyCode>57)&&(event.keyCode<96||event.keyCode>105)&&8!=event.keyCode)return!1;var e=$(this).val(),t=e.replace(/\s+/g,"").length;t>4&&(-1==e.substr(4,1).search(" ")?(e=e.replace(/\s+/g,""),$(this).val(e.substr(0,4)+" - "+e.substr(4,3))):-1==e.substr(5,1).search("-")?(e=e.replace(/\s+/g,""),$(this).val(e.substr(0,4)+" - "+e.substr(4,3))):-1==e.substr(6,1).search(" ")&&t>5&&$(this).val(e.substr(0,4)+" - "+e.substr(6)))}),$('.user_account_registration_form input[name = "login"]').blur(function(){if($(this).removeClass("error"),$(this).next(".error_message").remove(),""==$(this).val())$('.user_account_registration_form input[name = "login"]').after('<div class="fs13 error_message">Необходимо заполнить E-mail</div>');else if(/^(?:[a-z0-9_]+(?:[-_\.\+]?[a-z0-9-_\.]+)?@[a-z0-9\-]+(?:\.?[a-z0-9]+)?\.[a-z]{2,5})$/i.test($.trim($(this).val()))||"login"!=$(this).attr("name")){$(this).removeClass("error"),$(this).next(".error_message").remove();var e=$(".user_account_registration_form.custom"),t=e.find('input[name = "login"]');$.ajax({url:"/udata/users/check_email/",type:"POST",data:{login:t.val(),from_page:getQueryParam("from_page")||"/",authType:"ajax"},dataType:"xml",success:function(e){var t=$(e).find("status").text();"OK"==t?($('.user_account_registration_form input[name = "login"]').removeClass("error"),$('.user_account_registration_form input[name = "login"]').after('<div class="fs13 error_message green">Ваш e-mail одобрен!</div>')):($('.user_account_registration_form input[name = "login"]').addClass("error"),$('.user_account_registration_form input[name = "login"]').after('<div class="fs13 error_message">Такой e-mail уже существует!</div>'))}})}else $(this).addClass("error"),$(this).after('<div class="fs13 error_message">Неверный E-mail</div>')}),$('.user_account_registration_form input[name = "password"]').blur(function(){if($(this).removeClass("error"),$(this).next(".error_message").remove(),""==$(this).val())$('.user_account_registration_form input[name = "password"]').after('<div class="fs13 error_message">Необходимо заполнить Пароль</div>');else if(/^[-a-zA-Z0-9!#%&()*+,.\/~:;<=>?@[\]^_{|}]*$/i.test($.trim($(this).val()))||"password"!=$(this).attr("name")||($(this).addClass("error"),$(this).after('<div class="fs13 error_message">Пароль содержит запрещённые символы</div>')),$('.user_account_registration_form input[name = "password"]').val().length<8)$(this).addClass("error"),$(this).after('<div class="fs13 error_message">Минимально 8 символов</div>');else{$(this).removeClass("error"),$(this).next(".error_message").remove();var e=$(".user_account_registration_form.custom"),t=e.find('input[name = "password"]');$.ajax({url:"/udata/users/check_password/",type:"POST",data:{login:t.val(),from_page:getQueryParam("from_page")||"/",authType:"ajax"},dataType:"xml",success:function(e){var t=$(e).find("status").text();"OK"==t?($('.user_account_registration_form input[name = "password"]').removeClass("error"),$('.user_account_registration_form input[name = "password"]').after('<div class="fs13 error_message green">Ваш пароль одобрен!</div>')):($('.user_account_registration_form input[name = "password"]').addClass("error"),$('.user_account_registration_form input[name = "password"]').after('<div class="fs13 error_message">Такой пароль уже существует!</div>'))}})}}),$('.user_account_registration_form  input[name = "password_confirm"]').blur(function(){if($(this).removeClass("error"),$(this).next(".error_message").remove(),""==$(this).val())$('input[name = "password_confirm"]').after('<div class="fs13 error_message">Необходимо подтвердить Пароль</div>');else{var e=$('.user_account_registration_form input[name = "password"]').val(),t=$('.user_account_registration_form  input[name = "password_confirm"]').val();if(e!=t)return $('input[name = "password_confirm"]').after('<div class="fs13 error_message">Пароли не совпадают</div>'),!1;$('input[name = "password_confirm"]').after('<div class="fs13 error_message green">Пароли совпадают</div>')}}),$('.user_account_registration_form  input[name = "data[new][fname]"]').blur(function(){$(this).removeClass("error"),$(this).next(".error_message").remove(),""==$(this).val()?$(this).after('<div class="fs13 error_message">Необходимо заполнить Имя</div>'):($(this).removeClass("error"),$(this).next(".error_message").remove())}),$(".top_message_bar_close").click(function(){return $.cookie("city_mess",1,{expires:365,path:"/"}),location.reload(),!1}),$(".city_block a").click(function(){var e=$(this).attr("id").replace(/^city_/,"");return e=parseInt(e),$.ajax({url:"/udata/custom/set_city/"+e+"/",type:"POST",dataType:"xml",success:function(){location.reload()}}),!1}),$(".avemarket_cart").click(function(){}),$(".hours_delivery").click(function(){var e=$("#user_type").val();return"guest"==e?(show_form("authorization_form"),!1):!1}),$(".link_aut").click(function(){var e=$("#user_type").val();return"guest"==e?(show_form_aut(),!1):void 0}),$("#window_agreement .submit").click(function(){jQuery(".background_overlay").fadeOut(),$("#window_agreement").hide(),$("#map_search").focus()}),$("#window_dialog .cancel").click(function(){jQuery(".background_overlay").fadeOut(),$("#window_dialog").hide(),$("#map_search").focus()}),$("#window_dialog .submit").click(function(){jQuery(".background_overlay").fadeOut(),$("#window_dialog").hide(),$("#map_search").focus()}),$("#is_reg").length>0&&show_form("registration_form"),$(".add_card").click(function(){return $("#block_card").toggle(),!1}),$(".user_account_registration_card_wrapper").click(function(){return $(".user_account_registration_card_form").hide(),$(this).find(".user_account_registration_card_form").show(),$(this).find('input[name="user_card_number"]').focus(),!1}),$('label[for="check_add_agreement"] span.checkbox').click(function(){return!1}),$(".link_foget").click(function(){$("#authorization_form").hide();var e=document.body,t=document.documentElement,a=window.pageYOffset||t.scrollTop||e.scrollTop,r=a+100;$("#forget_form").css({top:r+"px","margin-left":"-260px"}).show();var i=$('#authorization_form input[name="login"]').val();return $('#forget_form input[name="forget_email"]').val(i),!1}),$(".authorization_form.custom").submit(function(){return $(this).find(".window_aut_button").click(),!1}),$("#window_authorization_form").submit(function(){return $(this).find(".window_aut_button").click(),!1}),$(".authorization_form.custom .autorization_radio .custom.radio").click(function(){$(this).hasClass("checked")?($(this).removeClass("checked"),$(this).siblings('input[type="radio"]').attr("checked","")):($(this).addClass("checked"),$(this).siblings('input[type="radio"]').attr("checked","checked"))}),$(".window_aut_button").click(function(){if($(this).hasClass("pop_up"))var e=$(this).parents("#window_authorization_form_pop_up");else var e=$(this).parents("#window_authorization_form");var t=e.find('input[name = "login"]'),a=e.find('input[name = "password"]'),r=1*e.find('input[name="save_authorization"][type="checkbox"]').is(":checked");return $.ajax({url:"/udata/users/check_access/",type:"POST",data:{login:t.val(),password:a.val(),from_page:getQueryParam("from_page")||"/"},dataType:"xml",success:function(i){var n=$(i).find("udata").text();1==n?$.ajax({url:"/udata/users/login_do/",type:"POST",data:{login:t.val(),password:a.val(),"u-login-store":r,from_page:getQueryParam("from_page")||location.href,authType:"ajax",userEnv:{wHeight:$(window).height(),wWidth:$(window).width()}},dataType:"xml",success:function(e){if(add_product_car){var t=$(add_product_car).attr("id").replace(/^add_basket_/,""),a=$("#count_"+t),r=a.find(".cart_count_value_input"),i=a.find('input[name = "weight_kg"]').val(),n=a.find('input[name = "weight_gram"]').val();if(r.length)var o=parseFloat(r.val());else var o=parseFloat(i+"."+n);update_block_cart(t,o,"put"),update_block_item($(add_product_car),o)}var s=$(e).find("redirect_to").text();s&&(location.href=s),location.reload()}}):(t.addClass("invalid"),a.addClass("invalid"),e.find("#window_authorization_error").html("Неверная пара Email-Пароль").show())}}),!1}),$(".aut_button_2").click(function(){var e=$("#aut_form_page"),t=e.find('input[name = "login"]'),a=e.find('input[name = "password"]');return $.ajax({url:"/udata/users/check_access/",type:"POST",data:{login:t.val(),password:a.val(),from_page:getQueryParam("from_page")||"/"},dataType:"xml",success:function(e){var r=$(e).find("udata").text();1==r?$("form#aut_form_page").submit():(t.addClass("invalid"),a.addClass("invalid"))}}),!1}),$(".window_forget_button").click(function(){var e=$("#window_forget_form"),t=e.find('input[name = "forget_email"]'),a=e.find(".error_message"),r=t.val();return show_loader_2(),$.ajax({url:"/udata/users/forget_do/",type:"POST",data:{forget_email:r},dataType:"xml",success:function(e){hide_loader_2(),t.removeClass("error"),a.hide();$(e).find("udata").text();$("#forget_form").hide(),show_window_agreement("На e-mail адрес, указанный Вами, были высланы </br> дальнейшие инструкции по восстановлению пароля.")},error:function(){hide_loader_2(),a.show(),t.addClass("error")}}),!1}),$(document).on("click",".item_defered_unavailable",function(){var e=$(this),t=e.attr("id").replace(/^unavailable_deferred_/,"");return $("#deferred_"+t).click(),!1}),$(document).on("click",".item_unavailable_remove",function(){var t=$(this).attr("id").replace(/^remove_item_unavailable_/,"");return update_block_cart(t,"","del"),$("#item_unavailable_"+t).fadeOut("slow").remove(),$("#cart_table_item_"+t).fadeOut("slow").remove(),e(),!1});var e=function(){var e=$('.sorry-time *[id*="item_unavailable_"].user_account_personal_data_subscriptions_item').length;0===e&&$(".sorry-time").fadeOut("slow").remove();var t=$('.sorry-no *[id*="item_unavailable_"].user_account_personal_data_subscriptions_item').length;0===t&&$(".sorry-no").fadeOut("slow").remove()};$("#address_list").change(function(){var e=$(this).find("option:selected").val();e=parseInt(e),window.location.href=e?"?number="+e:"?"}),$(".list_table_item_remove").click(function(){var e=$(this).attr("id").split("_"),t=e[2],a=e[3];return t&&a?($.ajax({url:"/udata/catalog/del_list_goods/",type:"POST",data:{good_id:t,list_id:a},dataType:"xml",success:function(e){var a=$(e).find("udata").text();"OK"==a&&$("#cart_table_item_"+t).remove()}}),!1):!1}),$("#deferred_to_basket").click(function(){$(".cart_watch_later_items_block").slideUp("slow"),$.ajax({url:"/udata/avemarket/deferred/basket_all/",type:"POST",data:{},dataType:"xml",success:function(e){$(e).find("udata").text()}}),location.reload()}),$("#baket_to_deferred").click(function(){$(".cart_active_elements_block").slideUp("slow"),$.ajax({url:"/udata/avemarket/basket/deferred_all/",type:"POST",async:!1,data:{},dataType:"xml",success:function(e){$(e).find("udata").text()}}),location.reload()}),$("#table_view_types a").click(function(){return $(this).hasClass("table")?$.cookie("mode_list_goods","table",{expires:365,path:"/"}):$.cookie("mode_list_goods","list",{expires:365,path:"/"}),document.location.reload(),!1}),$("#subject_other").click(function(){var e=$("#subject_block");return e.find("span").text("Тема:"),e.find('input[name = "subject_mess"]').show(),!1}),$(".new_subject").click(function(){var e=$(this).find("span").text(),t=$("#subject_block");return t.find("span").text("Тема: "+e),t.find('input[name = "subject_mess"]').val(e),!1}),$("#add_address_page").click(function(){return document.location.href="/personal/addresses/add_address/",!1}),$(".edit_address").click(function(){var e=$(this).attr("id").replace(/^addr_/,"");return e&&(document.location.href="/personal/addresses/edit_address/?number="+e),!1}),$('input[name = "user_card_number"]').click(function(){$(this).removeClass("invalid"),$(this).next(".fs13.error_message").text("")}),$("#send_mess").click(function(){var e=$("#form_message"),t=$('input[name = "subject_mess"]').val(),a=e.find("#message").val();if(!a)return $("#code_error").text("Необходимо заполнить поле Сообщение").show(),!1;var r=e.find('input[name = "fname"]').val(),i=e.find('input[name = "contact_info"]').val(),n=e.find('input[name = "captcha"]').val();return $("#code_error").hide(),show_loader_2(),$.ajax({url:"/udata/webforms/send_message/",type:"POST",data:{subject_mess:t,message:a,fname:r,contact_info:i,captcha:n},dataType:"xml",success:function(e){hide_loader_2();var t=$(e).find("udata").text();return 1==t?($(".all_form").hide(),$("#message_sent").show(),!1):$(e).find("error")?($("#code_error").text("Указан неверный код с картинки").show(),!1):void 0}}),!1});var t=!1;$("#fields_filter_form input").one("change",function(){if(!t){if(""!=$(this).data("url")&&void 0!=$(this).data("url")){var e=$(this),a=e.attr("name"),r=e.data("url").split(","),i=e.parents(".catalog_filters_scroll");if(e.hasClass("js-checkbox"))$('input[data-parent="'+e.val()+'"]').remove();else for(var n=1;n<r.length;n++)$('<input type="hidden" name="'+a+'" value="'+r[n]+'"/>').appendTo(i);$("#fields_filter_form").submit(),t=!0}else $("#fields_filter_form").submit(),t=!0;return!1}}),$(".filter_header_active input").one("change",function(){return t?void 0:(""!=$(this).data("url")&&void 0!=$(this).data("url")?($(this).parents("label").find('input[data-parent="'+$(this).val()+'"]').remove(),$(".filter_header_active").submit(),t=!0):($(".filter_header_active").submit(),t=!0),!1)}),$("#fields_filter_form .select_all").click(function(){return $(this).parent().parent().find("input").each(function(){$(this).attr("checked","checked")}),$("#fields_filter_form").submit(),!1}),$("#fields_filter_form .remove_all").click(function(){return $(this).parent().parent().find("input").each(function(){$(this).removeAttr("checked",""),$(this).hasClass("js-checkbox")&&$('input[data-parent="'+$(this).val()+'"]').remove()}),$("#fields_filter_form").submit(),!1}),$(".captcha_reset, .img_captcha").click(function(){var e=new Date;return $(".img_captcha").attr("src","/captcha.php?reset&"+e.getTime()),!1}),$(".modal_window > .modal_window_close").click(function(e){return $(".background_overlay").hide(),$("#authorization_form").hide(),$(this).closest(".modal_window, .user_account_registration_card_form").eq(0).hide(),$(".window_authorization_soc_error").hide(),$(".error_message").text(),$("#check_add_agreement_value").val(0),e.stopPropagation(),!1}),$(".user_account_registration_card_form .modal_window_close").click(function(e){return $(this).closest(".modal_window, .user_account_registration_card_form").eq(0).hide(),$(".error_message").text(),$("#check_add_agreement_value").val(0),e.stopPropagation(),!1}),$("#time-zone-up").click(function(){show_time_zone()}),$(".address_list").jScrollPane(),$(".shops_search_map_menu").jScrollPane({mouseWheelSpeed:25,autoReinitialise:!0})});var intervalID=0;$(document).ready(function(){initRecommendationsBasket();var e=$(".count-min"),t=$(".count-plus");e.click(function(){var e=$(this).siblings("input").val();e>1&&$(this).siblings("input").val(parseInt(e)-1)}),t.click(function(){var e=$(this).siblings("input").val();$(this).siblings("input").val(parseInt(e)+1)}),$("a[id^='link-list-delete_']").click(function(){var e=$(this).attr("id").split("_");if("favorites"==e[1]||"deferred"==e[1]||"recently"==e[1])var t="Вы действительно хотите удалить все товары этого списка?",a="Да, удалить",r="Нет, оставить";else var t="Вы действительно хотите удалить этот список?",a="Да, удалить",r="Нет, оставить";show_window_dialog(t,a,r),$("#window_dialog .submit").click(function(){window.location.href="/avemarket/lists_remove/"+e[1]+"/"})}),$("a.list_item_remove").click(function(){var e=$(this).parents(".slider_wrapper"),t=$(this).data(),a=$(this).parents(".category_page_table_catalog_item");return $.ajax({url:"/udata/avemarket/del_list_goods/"+t.listId+"/"+t.itemId}).done(function(t){var r=$(t).find("udata").text();"OK"===r&&(a.remove(),e.find(".category_page_table_catalog_item").length||e.html("<span style=\"font-size: 20px; font-family:'GalsLight'; padding-left:17px;\">Этот список пока пуст</span>"))}),!1}),$("a[id^='link-list-put-basket_']").click(function(){var e="Добавить все товары списка в корзину?",t="Да, добавить",a="Нет, оставить";show_window_dialog(e,t,a);var r=$(this).attr("id").split("_");$("#window_dialog .submit").click(function(){window.location.href="/avemarket/lists_add_to_cart/"+r[1]+"/"})}),$("a[id^='link-remove-address_']").click(function(){var e="Вы действительно хотите удалить этот адрес?",t="Да, удалить",a="Нет, оставить";show_window_dialog(e,t,a);var r=$(this).attr("id").split("_");$("#window_dialog .submit").click(function(){window.location.href="/udata/avemarket/del_address/"+r[1]+"/"})})}),$(document).ready(function(){$("a.fancybox").fancybox({helpers:{title:{type:"inside"},buttons:{}}}),$("input.date").datepicker(),$(".files .item").on("click",function(e){e.preventDefault();var t=$(this).find(".name a").attr("href");window.location.href=t})});var intervalID=0,register={};$(document).ready(function(){function e(){var e=$(window).width();return $(".top_14_02").css("width",e),$(".top_14_02").css("marginLeft",-e/2),!1}page_cart_manipulations(),$("#cart-registration-pop-up-1-3-button").click(function(){$("#cart-registration-pop-up-1-3").hide(),$("#cart-registration-pop-up-1-4").show()}),$("#cart-registration-pop-up-1-4-button").click(function(){$("#cart-registration-pop-up-1-4").hide(),$("#cart-registration-pop-up-1-5").show()}),$("#cart-registration-tab-header-1").click(function(){$("#cart-registration-tab-header-2").removeClass("active"),$("#tab_body_2").removeClass("active"),$(this).addClass("active"),$("#tab_body_1").addClass("active")}),$("#cart-registration-tab-header-2").click(function(){$("#cart-registration-tab-header-1").removeClass("active"),$("#tab_body_1").removeClass("active"),$(this).addClass("active"),$("#tab_body_2").addClass("active")}),$("#cart-registration-checkbox-show").click(function(){return $("#cart-registration-checkbox").show(),!1}),$("#cart-registration-checkbox-hide").click(function(){return $("#cart-registration-checkbox").hide(),!1}),$("#cart-registration-map-button").click(function(){return $("#cart-registration-map").show(),!1});var t=function(e,t){$(e).each(function(){var e=$(this).find(t).length>9;e&&$(this).jScrollPane({mouseWheelSpeed:35,verticalDragMinHeight:120,verticalDragMaxHeight:120})})};t(".catalog_filters_scroll","label"),t(".catalog_filters_scroll.filters_scroll_categoryes","li"),$(".category_page_catalog_body a.remove_in_catalog").click(function(){var e=this,t=$(this).attr("id").replace(/^item_remove_table_/,""),a=$("a.item_my_lists.current").attr("href").replace("?number=","");return $.ajax({url:"/udata/avemarket/lists/"+a+"/del/"+t+"/",type:"POST",dataType:"xml",success:function(){$(e).parents(".category_page_catalog_item_plate").fadeOut("slow")}}),!1});var a=$(".wrapper .my_lists").find("ul").length;5>a&&($(".wrapper .my_lists .slider_ctrl.left, .wrapper .my_lists .slider_ctrl.right").css("display","none"),$(".wrapper .my_lists.user_account_my_lists .slider_ctrl.left, .wrapper .my_lists.user_account_my_lists .slider_ctrl.right").css("display","block"));var r=$(".slider_recently_viewed_goods"),n=r.find(".slider_wrapper"),o=n.find("a.recently_viewed_goods_item").length;9>o&&r.find(".slider_ctrl").attr("disabled","disabled"),0!=$(".item_my_orders_history_wrapper").length&&$(".item_my_orders_history_wrapper").dotdotdot(),0!=$(".item_my_lists_wrapper").length&&$(".item_my_lists_wrapper").dotdotdot();var s=$("#reciples .pagination.gradient_light_gray .pagination_item");0==s.length&&$("#reciples .pagination.gradient_light_gray").css("display","none"),$(".mini_qr_img").click(function(){$(this).next(".fancybox").trigger("click")}),document.mousewheel&&$('input[type="number"]').mousewheel(function(){return!1}),setTimeout(function(){$('input[type="number"][name="weight_thing"]').blur(function(){var e=$(this),t=99,a="thing",r=e.attr("id").replace(/^count_value_/,"");inputVerification(e,t,a,r);e.val()})},1e3),setTimeout(function(){$('input[type="number"][name="weight_thing"]').keypress(function(e){return 13==e.keyCode?!1:void 0})},1e3),$(document).on("blur",'input[type="number"][name="weight_kg"]',function(){inputWeightKgBlur($(this))}),$(document).on("blur",'input[type="number"][name="weight_gram"]',function(){inputWeightGramBlur($(this))}),$(document).on("blur",".cart_count_value_input",function(){inputVerification($(this))});var d=$('input[type="number"][name="weight_thing"]');for(i=0;i<d.length;i++){var c=d[i].value;if(2>c){{d[i]}$(d[i]).parent(".cart_count_value").siblings(".cart_count_decrement").addClass("grey_btn")}if(c>98){{d[i]}$(d[i]).parent(".cart_count_value").siblings(".cart_count_increment").addClass("grey_btn")}}$(".top_14_02")&&(e(),$(window).resize(function(){e()})),$("#goUp").hide(),$(window).scroll(function(){$(this).scrollTop()>100?$("#goUp").fadeIn():$("#goUp").fadeOut()}),$("#goUp, .live-line-guest-cart .live-line-guest-cart-up").click(function(){return $("body,html").animate({scrollTop:0},800),!1}),$(window).scroll(function(){if(window.skip_live_line_guest_cart!==!0){var e=$(this).scrollTop(),t=$(".live-line-guest-cart");if(e>355){if(t.is(":visible"))return!1;t.fadeIn()}else t.fadeOut()}}),$(function(){$(".slider_wrapper.category_page_catalog_body img").lazyload({threshold:200})
}),$(function(){$(".cart_table_item img").lazyload()}),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&$("body").addClass("i"),fancyboxLoopFalse=function(e){e.fancybox({cyclic:!1,loop:!1})},fancyboxLoopFalse($("a.photo_in_article_photo")),$('a[data-class="description_action_show"]').click(function(){$(this).addClass("display_none"),$('a[data-class="description_action_hide"]').removeClass("display_none"),$(".text_action_show").slideDown(500)}),$('a[data-class="description_action_hide"]').click(function(){$(this).addClass("display_none"),$(".text_action_show").slideUp(500),$('a[data-class="description_action_show"]').removeClass("display_none")})}),$(".small_quantity .close, .small_quantity_in_cart .close").click(function(){$(this).parents(".small_quantity, .small_quantity_in_cart").removeClass("display_block").addClass("display_none")}),$(".small_quantity").not(".display_none").parents(".product_card_cartlabel_bottom_block").find(".cart_count_increment").addClass("grey_btn"),$(document).ready(function(){social_registration_controller={openWindowSocialAut:function(){$(".window_social_registration").delegate("a.big_icons_social","click",function(){var e=$(this).attr("href"),t=($(this).attr("data-name"),658),a=378,r=(screen.width-t)/2,i=(screen.height-a)/2;return myWin=window.open(e,"social_authoriz","width="+t+",height="+a+",left="+r+",top="+i+", status=no,toolbar=no,menubar=no"),!1})},remove_social_session:function(){$(".remove_social_session").click(function(){return $.ajax({url:"/udata/users/clearSocialDataFromSession",type:"GET",dataType:"xml",success:function(){location.reload()},error:function(){alert("Попробуйте еще!")}}),!1})},icons_social_on_off:function(){$(".window_social_registration").delegate(".icons_social_on_off.act","click",function(){var e=$(this),t=e.next(".left"),a=e.attr("href"),r=$(this).attr("data-name");return $.ajax({url:a,type:"GET",dataType:"xml",success:function(a){var i=$(a).find("udata").text();"ok"==i?$.ajax({url:"/udata/users/getHrefSocialAuth/"+r,type:"POST",dataType:"xml",success:function(a){var r=$(a).find("udata").text();e.attr("href",r).removeClass("act").addClass("no_act big_icons_social"),t.attr("style","padding-left: 5px;width:68px;line-height:40px").text("Отключено"),$(".soc_error").hide(),$("a").is(".act")?$("#error_social_account_off").show():$("#error_social_account_all_off").show()}}):location.reload()},error:function(){alert("Попробуйте еще!")}}),!1})},show_window_authorization_soc_error:function(){$(".soc_error").hide(),$(".window_authorization_soc_error").show()},show_error_social_account_already_exists:function(){$(".soc_error").hide(),$("#error_social_account_already_exists").show()},eventFunction:function(){social_registration_controller.openWindowSocialAut(),social_registration_controller.remove_social_session(),social_registration_controller.icons_social_on_off()}},social_registration_controller.eventFunction();var e=-1;search_controller={showHideSearchPanel:function(){$("header .expand_search_block .search_submit_input, article .expand_search_block .search_submit_input").focus(function(){$(".expand_search_block").removeClass("open").find(".search_complete_wrapper").hide(),$(this).closest(".expand_search_block").addClass("open").find(".search_complete_wrapper").show()}).keydown(function(t){if(38==t.keyCode&&e>0)return e--,$("header .expand_search_block .left_menu li").removeClass("hover").eq(e).addClass("hover"),$("article .expand_search_block .left_menu li").removeClass("hover").eq(e).addClass("hover"),!1;if(40==t.keyCode){var a=$("header .expand_search_block .left_menu li").length;if(a-1>e)return e++,$("header .expand_search_block .left_menu li").removeClass("hover").eq(e).addClass("hover"),$("article .expand_search_block .left_menu li").removeClass("hover").eq(e).addClass("hover"),!1}if(13==t.keyCode&&"search_string"==$(this).attr("name")){if(-1==e)var r=$(this).val();else var r=$("header .expand_search_block .left_menu li.hover").text();return location.href="/search_page/?search_string="+r,!1}}),$(document).click(function(t){0==$(t.target).closest(".expand_search_block_wnd").length&&($(".expand_search_block.open").removeClass("open").find(".search_complete_wrapper").hide(),$(".expand_search_block li").removeClass("hover"),e=-1)}),$(".search_clear").on("click",function(){$(this).siblings(".search_submit_input").val("")})},searchBlockLiClick:function(){$(".expand_search_block li").on("click",function(){var e=$(this).html();$(".search_submit_input").val(e),$(".header_search_form").submit()}),$(".grey_button_clear_search").on("click",function(){$(this).siblings(".left_menu").html(""),$(this).parent().css("display","none"),$.cookie("search_strings",null)})},searchAutocomplite:function(){$(".search_submit_input").keyup(function(t){var a=$(this).val();a.length>2&&38!==t.keyCode&&40!==t.keyCode&&13!==t.keyCode&&$.ajax({url:"/udata/searchav/autocompleteSearch.json?search="+a,type:"GET",data:{},dataType:"json",success:function(t){e=-1;var a="";jQuery.each(t.items,function(e,t){a+="<li>"+t+"</li>"}),$("#search_list ul.left_menu, #search_list_center ul.left_menu").html(a),$("#search_list, #search_list_center").css("display","block"),$("#introduced ul.left_menu, #introduced_center ul.left_menu").html(""),$("#introduced, #introduced_center").css("display","none"),search_controller.searchBlockLiClick()}})})},readCookies:function(){var e=document.cookie,t=e.split("; ");jQuery.each(t,function(e,t){var a="search_strings",r=t.match(a);if(r){r=t.replace("search_strings=","");var i=decodeURI(r).replace(/\%2C/gi,",").replace(/\%3A/gi,":");if(null!=i){textsCookie=JSON.parse(i);var n="";jQuery.each(textsCookie,function(e,t){n+="<li>"+t.replace("+"," ")+"</li>"}),$("#introduced ul.left_menu, #introduced_center ul.left_menu").html(n),$("#introduced, #introduced_center").css("display","block"),search_controller.searchBlockLiClick()}}})}},search_controller.showHideSearchPanel(),search_controller.searchBlockLiClick(),search_controller.searchAutocomplite(),search_controller.readCookies()});var intervalEditItemInCart=Array();$(document).ready(function(){linkSearchGet(),$("#add_address_user").click(function(){var e=collection_address_data(),t=check_address_details();if(t)return!1;if(!e.full_str_address||!e.coordinates)return!1;if($(this).hasClass("grey_btn"))return!1;show_loader_2(),$("#window_dialog .green_btn.submit.button_ok").unbind("click");var a,r,i,n;return 0==$('input[name = "area_search_id"]').val()&&$.ajax({url:"/udata/avemarket/check_address_out_delivery_area/"+e.coordinates,type:"POST",async:!1,dataType:"xml",success:function(e){n=$(e).find("udata").text()}}),"1"==n?(hide_loader_2(),a="У Вас есть адресс для корреспонденции, заменить?",r="Да, заменить",i="Нет, не менять",show_window_dialog(a,r,i),$("#window_dialog .green_btn.submit.button_ok").click(function(){$.ajax({url:"/udata/avemarket/deleteAddressesOutsideZoneDeliveryExceptSelected/",type:"POST",dataType:"xml",success:function(){$.ajax({url:"/udata/avemarket/add_address/",type:"POST",data:e,dataType:"xml",success:function(e){hide_loader_2(),$("#window_dialog").hide();var t=$(e).find("status").text();"OK"==t?a="Адрес успешно добавлен":"NO_DELIVERY"==t&&(a="Доставка по данному адресу невозможна, адрес только для корреспонденций"),show_window_agreement(a),$(".button_ok").click(function(){document.location.href="/personal/addresses/"})}})}})}),!1):($.ajax({url:"/udata/avemarket/add_address/",type:"POST",data:e,dataType:"xml",success:function(e){hide_loader_2();var t=$(e).find("status").text();"OK"==t?a="Адрес успешно добавлен":"NO_DELIVERY"==t&&(a="Доставка по данному адресу невозможна, адрес только для корреспонденций"),show_window_agreement(a),$(".button_ok").click(function(){document.location.href="/personal/addresses/"})}}),!1)}),$("#save_address_user").click(function(){if($(this).hasClass("grey_btn"))return!1;var e=collection_address_data(),t=check_address_details(),a=e.addr_id;if(t)return!1;if(!e.addr_id||!e.full_str_address||!e.coordinates)return!1;show_loader_2(),$("#window_dialog .green_btn.submit.button_ok").unbind("click");var r,i,n,o;return $.ajax({url:"/udata/avemarket/check_address_out_delivery_area/"+e.coordinates+"/"+a,type:"POST",async:!1,dataType:"xml",success:function(e){o=$(e).find("udata").text()}}),"1"==o?(hide_loader_2(),r="У Вас есть адрес для корреспонденции, заменить?",i="Да, заменить",n="Нет, не менять",show_window_dialog(r,i,n),$("#window_dialog .green_btn.submit.button_ok").click(function(){$.ajax({url:"/udata/avemarket/ajaxDeleteAddressesOutsideZoneDeliveryExceptSelected/",type:"POST",data:{address_id:a},dataType:"xml",success:function(){$.ajax({url:"/udata/avemarket/save_address/",type:"POST",data:e,dataType:"xml",success:function(e){$("#window_dialog").hide();var t=$(e).find("status").text();"OK"==t?r="Адрес успешно изменён":"NO_DELIVERY"==t&&(r="Доставка по данному адресу невозможна, адрес только для корреспонденций"),$(".div_button_map").css("z-index","1000"),$(".green_btn.submit.button_ok").html("ОК"),show_window_agreement(r),$(".button_ok").click(function(){document.location.href="/personal/addresses/"})}})}})}),!1):($.ajax({url:"/udata/avemarket/save_address/",type:"POST",data:e,dataType:"xml",success:function(e){hide_loader_2();var t=$(e).find("status").text();"OK"==t?r="Адрес успешно изменён":"NO_DELIVERY"==t&&(r="Доставка по данному адресу невозможна, адрес только для корреспонденций"),$(".div_button_map").css("z-index","1000"),show_window_agreement(r),$(".button_ok").click(function(){document.location.href="/personal/addresses/"})}}),!1)}),$('input[name = "address_details"], textarea[name = "full_str_address"]').blur(function(){check_address_details()}),$(".registration_step1").click(function(){var e=$("#check_add_agreement_value").val();if(e=parseInt(e),1==e){var t=$("#registration_form");if(!validateForm(t))return $("body,html").animate({scrollTop:0},600),!1;var a=$("#register_form_user_contact_phone");return""!=a.val()&&a.hasClass("error")?!1:($("#registration_form").hide(),$("#add_address_form").show(),$("body,html").animate({scrollTop:0},600),upload_api_yandex_map(),!1)}return!1}),$(".add_agreement").click(function(){var e=$("#check_add_agreement_value").val();e=parseInt(e);var t=$('label[for="check_add_agreement"] span.checkbox');return 1==e?($("#check_add_agreement_value").val(0),$(".registration_step1").addClass("grey_btn"),t.removeClass("checked")):($("#check_add_agreement_value").val(1),$(".registration_step1").removeClass("grey_btn"),t.addClass("checked")),!1}),$(".user_account_registration_form_submit").click(function(){show_loader_2(),$("body,html").animate({scrollTop:0},600);var e=collection_personal_data(),t=collection_notification_data();return $.ajax({url:"/udata/users/new_registrate_do/",type:"POST",data:{login:e.login,email:e.login,password:e.password,password_confirm:e.password_confirm,fname:e.fname,day:e.day,month:e.month,data:e.data,number_card:e.number_card,type_card:e.type_card,spam_allowed:e.spam_allowed,card_img_id:e.card_img_id,notification_data:t,social_name:e.social_name,uid:e.uid},dataType:"xml",success:function(){hide_loader_2(),document.location.href="/users/registrate_done/"}}),!1}),$(".user_account_and_address_registration_form_submit").click(function(){if($(this).hasClass("gray_submit"))return!1;var e=collection_personal_data(),t=collection_notification_data(),a=check_address_details();return a?!1:(show_loader_2(),$("body,html").animate({scrollTop:0},600),$.ajax({url:"/udata/users/new_registrate_do/",type:"POST",data:{login:e.login,email:e.login,password:e.password,password_confirm:e.password_confirm,fname:e.fname,day:e.day,month:e.month,number_card:e.number_card,type_card:e.type_card,spam_allowed:e.spam_allowed,data:e.data,card_img_id:e.card_img_id,notification_data:t,social_name:e.social_name,uid:e.uid},dataType:"xml",success:function(){var e=collection_address_data();$.ajax({url:"/udata/avemarket/add_address/",type:"POST",data:e,dataType:"xml",success:function(e){hide_loader_2();$(e).find("status").text();document.location.href="/users/registrate_done/"}})}}),!1)}),$(".user_account_registration_block").find(".save_card_number").click(function(){var e=collection_data_discount_card($(this));return e.number_card?void $.ajax({url:"/udata/avemarket/request_value_proc/",type:"POST",data:{number_card:e.number_card,type_card:e.type_card,card_img_id:e.card_img_id},dataType:"xml",success:function(t){var a=$(t).find("udata").text();if(isNaN(a))$(".private_discount_card").hide(),e.card_error.show().text(a);else{var r=$(".private_discount_card");r.find("img").attr("src",e.card_img_src),r.show().find(".my_discount_current_value").html(a+"%"),r.find('input[name = "personal_user_card_number"]').val(e.number_card),r.find('input[name = "personal_card_type"]').val(e.type_card).attr("card_img_id",e.card_img_id),$("#block_card").hide()}}}):(e.card_input_number.addClass("invalid"),e.card_error.text("Укажите номер"),setTimeout("$('input[name = \"user_card_number\"]').removeClass('invalid');$('.fs13.error_message').text('');",1e3),!1)}),$('form.user_account_personal_data_form input[name = "fname"]').keyup(function(){var e=$(this).val();e.length>0?$("form.user_account_personal_data_form button").removeClass("grey_btn"):$("form.user_account_personal_data_form button").addClass("grey_btn")}),$("form.user_account_personal_data_form button").click(function(){if($(this).hasClass("grey_btn"))return!1;var e=collection_personal_edit_data(),t=collection_notification_data();return $.ajax({url:"/udata/users/edit_personal_data/",type:"POST",data:{email:e.email,name:e.name,day:e.day,month:e.month,phone:e.phone,spam_allowed:e.spam_allowed,general_notifications:e.general_notifications,notification:t},dataType:"xml",success:function(e){var t=($(e).find("udata").text,"Данные успешно изменены");show_window_agreement(t),$(".background_overlay").show(),$("#window_agreement").show()}}),!1}),$(".user_account_discount_block").find(".save_card_number").click(function(){var e=collection_data_discount_card($(this));return e.number_card?($.ajax({url:"/udata/avemarket/save_card_number/",type:"POST",data:{number_card:e.number_card,type_card:e.type_card,card_img_id:e.card_img_id},dataType:"xml",success:function(t){var a=$(t).find("udata").text();if("OK"==a){e.card_input_number.removeClass("invalid"),e.card_error.text("Карта одобрена");var r=$("#user_type").val();"guest"==r||setTimeout("$('input[name = \"user_card_number\"]').removeClass('invalid');$('.fs13.error_message').text('');$('.user_account_registration_card_form').hide();location.reload();",1e3)}else e.card_input_number.addClass("invalid"),e.card_error.text(a),setTimeout("$('input[name = \"user_card_number\"]').removeClass('invalid');$('.fs13.error_message').text('');",1e3)}}),!1):(e.card_input_number.addClass("invalid"),e.card_error.text("Укажите номер"),setTimeout("$('input[name = \"user_card_number\"]').removeClass('invalid');$('.fs13.error_message').text('');",2e3),!1)}),$('.user_account_registration_form input[name = "phone"]#register_form_user_contact_phone').blur(function(){if($(this).removeClass("error"),$(this).next(".error_message").remove(),""==$(this).val())return!1;$(this).removeClass("error"),$(this).next(".error_message").remove();var e=$(".user_account_registration_form.custom"),t=e.find('input[name = "phone"]#register_form_user_contact_phone');$.ajax({url:"/udata/users/check_phone/",type:"POST",data:{phone:t.val(),authType:"ajax"},dataType:"xml",success:function(e){var t=$(e).find("status").text(),a=$(e).find("errorMessage").text();"OK"==t?($('.user_account_registration_form input[name = "phone"]#register_form_user_contact_phone').removeClass("error"),$('.user_account_registration_form input[name = "phone"]#register_form_user_contact_phone').after('<div class="fs13 error_message green">Ваш номер одобрен!</div>')):($('.user_account_registration_form input[name = "phone"]#register_form_user_contact_phone').addClass("error"),$('.user_account_registration_form input[name = "phone"]#register_form_user_contact_phone').after('<div class="fs13 error_message">'+a+"</div>"))}})}),$("input[name=phone]").keyup(function(){fieldPhone("input[name=phone]")}),$(".forget_modal_window_close").click(function(){return $("#forget_form").hide(),$(".background_overlay").hide(),!1}),$(".user_account_authorization_form button").click(function(){var e=$("form.user_account_authorization_form"),t=$('input[name="old_password"]').val(),a=$('input[name="new_password"]').val(),r=$('input[name="new_password_confirm"]').val();return $(".old_password_error").addClass("display_none"),a!=r?($(".new_password_error").removeClass("display_none"),!1):($(".new_password_error").addClass("display_none"),show_loader_2(),$.ajax({url:"/udata/users/password_change/",type:"POST",data:{old_password:t,new_password:a,new_password_confirm:r},dataType:"xml",success:function(t){hide_loader_2();var a=$(t).find("udata").text();if("Старый пароль введён не верно"==a)return $('input[name="old_password"]').val(""),$('input[name="new_password"]').val(""),$('input[name="new_password_confirm"]').val(""),$('input[name="old_password"]').focus(),$(".old_password_error").removeClass("display_none"),!1;if("OK"==a){e.find("input").val("");var r="Пароль успешно изменён, на Ваш Еmail выслан новый пароль";show_window_agreement(r),$(".background_overlay").show(),$("#window_agreement").show()}}}),!1)}),$(".user_account_registration_block").find(".save_card_number").click(function(){var e=collection_data_discount_card($(this));return e.number_card?void $.ajax({url:"/udata/avemarket/request_value_proc/",type:"POST",data:{number_card:e.number_card,type_card:e.type_card,card_img_id:e.card_img_id},dataType:"xml",success:function(t){var a=$(t).find("udata").text();if(isNaN(a))$(".private_discount_card").hide(),e.card_error.show().text(a);else{var r=$(".private_discount_card");r.find("img").attr("src",e.card_img_src),r.show().find(".my_discount_current_value").html(a+"%"),r.find('input[name = "personal_user_card_number"]').val(e.number_card),r.find('input[name = "personal_card_type"]').val(e.type_card),$("#block_card").hide()}}}):(e.card_input_number.addClass("invalid"),e.card_error.text("Укажите номер"),setTimeout("$('input[name = \"user_card_number\"]').removeClass('invalid');$('.fs13.error_message').text('');",1e3),!1)}),$("#request_value_proc").click(function(){$("#value_proc").hide();var e=$('select[name = "type_card"] option:selected').val(),t=$('input[name = "number_card"]').val();return e||t?($.ajax({url:"/udata/avemarket/request_value_proc/",type:"POST",data:{type_card:e,number_card:t},dataType:"xml",success:function(e){var t=$(e).find("udata").text();isNaN(t)?($("#error_search").show().text(t),$("#value_proc").hide()):($("#error_search").hide(),$("#value_proc").show().find(".check_card_info_left_percents").html(t+"%"))}}),!1):!1}),$("a.select_card").click(function(){$(".background_overlay").show(),$("#discount_card_pop_up").show()}),$("#del_discount_card").on("click",function(){var e=$(this).attr("card-id");return $.ajax({url:"/udata/avemarket/unlink_personal_card_user/"+e,type:"POST",dataType:"xml",success:function(e){var t=$(e).find("udata").text();switch(t){case"update":window.location.reload();break;case"card_param_undefined ":alert("Не передан ID карты");break;case"user_not_found":alert("Пользователь не найден");break;case"card_not_found":alert("Не найден объект карты");break;case"user_not_auth":alert("Вы не авторизованы");break;default:window.location.reload()}return!1}}),!1}),$("div#discount_card_pop_up a.modal_window_close").click(function(){return $(".background_overlay").hide(),$("#discount_card_pop_up").hide(),!1}),$(".card_pop_up").click(function(){$(".card_pop_up").removeClass("selected"),$(this).toggleClass("selected")}),$("#selection_discount_card").click(function(){if(!$(".card_pop_up").hasClass("selected"))return!1;var e=$(".card_pop_up.selected"),t=$('select[name = "type_card"]'),a=e.attr("id-card");$(".select_card span").html("Изменить карту"),t.next("div").find("li").eq(a-1).click(),t.attr("card-index-id",a),$(".select_card img").attr("src","/images/card_img/small/card ("+a+").png").removeClass("display_none"),$("#discount_card_pop_up").hide(),$(".background_overlay").hide()}),$(".forget_modal_window_close").click(function(){return $("#forget_form").hide(),$(".background_overlay").hide(),!1}),$("#message_catalog_ok").on("click",function(){return $(this).parents(".message").fadeOut(500),$.ajax({url:"/udata/avemarket/hideMessage/message_catalog/",type:"POST",async:!1,dataType:"xml",success:function(){}}),!1}),$("a.goods_item span").click(function(){var e;if($(this).hasClass("all_goods")){$.cookie("available_to_order","all_goods",{path:"/"});var t="alphabet";$.cookie("sort",t,{path:"/"}),e=linkAddGet(window.location.href,!0)}else{$.cookie("available_to_order","available_goods",{path:"/"});var t="popularity";$.cookie("sort",t,{path:"/"}),e=linkAddGet(window.location.href)}return window.location.href=e,!1}),$("span.private_house").click(function(){var e=$('input[name = "address_details"]');if(e.attr("disabled"))e.removeAttr("disabled");else{e.attr("disabled","disabled").removeClass("error");var t=e.attr("name")+"_error";$("div#"+t).hide()}check_address_details()}),$("#table_sort_types li a ").click(function(){var e=$(this).attr("sort");$.cookie("sort",e,{path:"/"}),location.reload()}),$(".assay_dropdown li a ").click(function(){location.href=$(this).attr("href")}),$(".wrapper").on("click",".add_to_cart_btn",function(){var e=($("#user_type").val(),$(this).attr("id").replace(/^add_basket_/,"")),t=$(this).attr("category_id"),a=$(this).attr("name"),r=$(this).attr("item_type"),i=$(this).attr("original_price"),n=Number($(this).attr("price")),o=$(this).attr("category_name"),s=$("#count_"+e),d=s.find(".cart_count_value_input"),c=s.find('input[name = "weight_kg"]').val(),l=s.find('input[name = "weight_gram"]').val(),_=$(this).attr("amount_basket")||0;if(d.length)var u=parseFloat(d.val());else var u=parseFloat(c+"."+l);verificationQuantity(e,u);var m=s.find(".cart_count_value_input"),p=s.find('input[name = "weight_kg"]').val(),f=s.find('input[name = "weight_gram"]').val();if(m.length)var h=parseFloat(m.val());else var h=parseFloat(p+"."+f);h!=u&&(u=h,$("div[id$="+e+"]").find(".small_quantity").removeClass("display_block").addClass("display_none"),$("div[id$="+e+"]").find(".small_quantity_in_cart").removeClass("display_none").addClass("display_block")),_gaq.push(["_trackEvent","Buying","AddToCart",o,i]);var v={name:a,id:e,price:n,category:o,type:r};return u-_>0&&(v.quantity=u-_,$(document).trigger("products-add-to-cart",v)),0>u-_&&(v.quantity=_-u,$(document).trigger("products-remove-from-cart",v)),$(this).attr("amount_basket",u),update_block_cart(e,u,"put"),update_block_item($(this),u),$("div").is(".cart_active_elements_block'")&&update_cart_block_visual(),$(this).hasClass("add_recommendations")||$("div").is(".cart_watch_later_items_block")&&$("#deferred_table_item_"+e).remove()&&update_block_deferred(e,"","del"),"undefined"==typeof __GetI&&(__GetI=[]),function(){var a={type:"CART_ADD",user_id:$('input[name="user_type"]').attr("user_id"),site_id:"131",product_id:e,category_id:t,product_price:i};__GetI.push(a);var r="undefined"==typeof __GetI_domain?"px.adhigh.net":__GetI_domain;a.forward_tag=a.forward_tag||!1;var n=("https:"==document.location.protocol?"https://":"http://")+r+"/p.js",o=document.createElement("script");o.type="text/javascript",o.src=n,document.body.appendChild(o)}(),$.ajax({url:"/udata/avemarket/addToRecentlyList/"+e,type:"GET"}),!1}),$(".user_account_my_lists").on("click",".add_deferred",function(){var e=$(this),t=e.attr("id").replace("deferred_","").replace("dynamic_",""),a=$("#count_"+t),r=a.find(".cart_count_value_input"),i=a.find('input[name = "weight_kg"]').val(),n=a.find('input[name = "weight_gram"]').val();if(r.length)var o=parseFloat(r.val());else var o=parseFloat(i+"."+n);return $.ajax({url:"/udata/avemarket/move_add_deferred/add/"+t+"/"+o,type:"POST",async:!1,dataType:"xml",success:function(e){var a=$(e).find("udata").text();$("#cart_table_item_"+t).remove(),"NONE"==a&&($(".cart_active_elements_block").addClass("display_none"),$(".cart_empty_message.cart").removeClass("display_none"))}}),!1}),$(".blocks_elements_items_dishes").delegate(".add_deferred","click",function(){var e=$(this),t=e.attr("id").replace("deferred_","").replace("dynamic_",""),a=$("#cart_table_item_"+t),r=a.attr("name"),i=a.attr("category_name"),n=a.attr("price"),o=(a.attr("original_price"),a.attr("item_type")),s=$("#count_"+t),d=s.find(".cart_count_value_input"),c=s.find('input[name = "weight_kg"]').val(),l=s.find('input[name = "weight_gram"]').val();if(d.length)var _=parseFloat(d.val());else var _=parseFloat(c+"."+l);$.ajax({url:"/udata/avemarket/move_cart_product_to_deferred/"+t,type:"POST",async:!1,dataType:"xml",success:function(e){var a=$(e).find("udata").text();$("#cart_table_item_"+t).remove(),"NONE"==a&&($(".cart_active_elements_block").addClass("display_none"),$(".cart_empty_message.cart").removeClass("display_none"))}});var u={name:r,id:t,price:n,category:i,quantity:_,type:o};return $(document).trigger("products-remove-from-cart",u),update_block_cart(t,"","del"),update_cart_block_visual(),update_deferred_block_visual(),$("#dynamic_cart_table_item_"+t).remove(),$("#cart_table_item_"+t).remove(),$('[data-deferred="success"]').addClass("g-hidden"),!1}),$(document).on("click",'[data-deferred="products"]',function(){var e=$(this).parents('[data-time="tabs-item"]'),t=e.find('[data-deferred="success"]');return $('[data-deferred="success"]').addClass("g-hidden"),$.ajax({url:"/udata/avemarket/productsToDeferred/",type:"POST",async:!1,dataType:"xml",success:function(e){var a=$(e).find("udata").text();"1"==a&&(t.prev(".b-time-block").addClass("g-hidden"),t.removeClass("g-hidden"),update_block_cart(),update_cart_block_visual(),update_deferred_block_visual())}}),!1}),$(".blocks_elements_items_dishes").on("click",'[data-to-deferred="products"]',function(){return $.ajax({url:"/udata/avemarket/productsToDeferred/",type:"POST",async:!1,dataType:"xml",success:function(e){var t=$(e).find("udata").text();"1"==t&&(update_block_cart(),update_cart_block_visual(),update_deferred_block_visual())}}),!1}),$(document).on("click",'[data-deferred="dishes"]',function(){var e=$(this).parents('[data-time="tabs-item"]'),t=e.find('[data-deferred="success"]'),a=e.find('[data-button="time_slot_ok"]');return $('[data-deferred="success"]').addClass("g-hidden"),$.ajax({url:"/udata/avemarket/dishesToDeferred/",type:"POST",async:!1,dataType:"xml",success:function(e){var r=$(e).find("udata").text();"1"==r&&(t.prev(".b-time-block").addClass("g-hidden"),t.removeClass("g-hidden"),a.removeClass("grey_btn g-hidden"),update_block_cart(),update_cart_block_visual(),update_deferred_block_visual())}}),!1}),$(".blocks_elements_items_dishes").on("click",'[data-to-deferred="dishes"]',function(){return $.ajax({url:"/udata/avemarket/dishesToDeferred/",type:"POST",async:!1,dataType:"xml",success:function(e){var t=$(e).find("udata").text();"1"==t&&(update_block_cart(),update_cart_block_visual(),update_deferred_block_visual())}}),!1}),$(".cart_watch_later_items_block").delegate(".deferred_add_to_cart_btn","click",function(){var e=$(this).attr("id").replace("add_basket_",""),t=$("#count_"+e),a=t.find(".cart_count_value_input"),r=t.find('input[name = "weight_kg"]').val(),i=t.find('input[name = "weight_gram"]').val(),n=$(this).attr("item_type"),o=$(this).attr("name"),s=$(this).attr("category_name"),d=$(this).attr("original_price");if(a.length)var c=parseFloat(a.val());else var c=parseFloat(r+"."+i);$.ajax({url:"/udata/avemarket/move_deferred_product_to_cart/"+e,type:"POST",async:!1,dataType:"xml",success:function(t){var a=$(t).find("udata").text();$("#deferred_table_item_"+e).remove(),"NONE"==a&&($(".cart_empty_message.deferred").removeClass("display_none"),$(".cart_watch_later_items_block").not(".recommendations-items").addClass("display_none"))}});var l={name:o,id:e,price:d,category:s,quantity:c,type:n};$(document).trigger("products-add-to-cart",l),update_block_cart(e,c,"put"),update_cart_block_visual(),page_cart_manipulations(),$('[data-deferred="success"]').addClass("g-hidden");var _="000",u=_.substring(0,_.length-i.length)+i;return actualID=$(this).attr("id"),actualID=actualID.substring(11),$(".basket#weight_gram_"+actualID).val(u),!1}),$(".cart_watch_later_items_block").delegate(".deferred_table_item_remove","click",function(){var e=$(this).attr("id").replace(/^item_remove_/,"");update_block_deferred(e,"","del"),$("#deferred_table_item_"+e).remove(),$(".cart_watch_later_items_block").not(".recommendations-items").find(".category_page_table_catalog_item").length||($(".cart_empty_message.deferred").removeClass("display_none"),$(".cart_watch_later_items_block").not(".recommendations-items").addClass("display_none"))}),$("div.online_order_button").click(function(){show_loader_2();var e=$(this).attr("id"),t="<p>Вы уверены, что оплата заказа произведена, и у Вас есть подтверждение транзакции от банка (например, по смс или электронной почте)? В этом случае мы свяжемся с Вами по телефону в течение нескольких минут, и подтвердим ваш заказ.</p>";$.ajax({url:"/udata/avemarket/orderPaymentAction/",data:{order_action:e},type:"POST",dataType:"xml",success:function(a){var r=$(a).find("redirect").text();"custumber_paid"==e?(hide_loader_2(),show_window_agreement(t),$("#window_agreement .button_ok").click(function(){document.location.href=r})):document.location.href=r}})}),$(".list_block").delegate("a.item_list","click",function(){var e=$(this).closest(".f-dropdown"),t=$(this).attr("id").split("_"),a=$(this).data("to-list")||null,r=t[1],i=t[2];return $.ajax("wholecart"==r?{url:"/udata/avemarket/wholecart_to_list_json/"+i+"/",type:"POST",data:{group:a},dataType:"xml",success:function(t){var a=$(t).find("udata").text();"OK"==a&&(show_success_list_notififcation(i),e.hide())}}:{url:"/udata/avemarket/add_list_goods/"+i+"/"+r+"/",type:"POST",data:{},dataType:"xml",success:function(t){var a=$(t).find("udata").text();"OK"==a&&(show_success_list_notififcation(i),e.hide())}}),!1}),$("p.section_header").click(function(){var e=$(this).next();e.find(".section_header_tab:first").click()}),page_cart_manipulations(),available_item(),controlOrderingButtons(),chemMogu()});var hideSorryNoItems=function(){if($(".sorry-no").length>0){for(var e in $(".sorry-no .cart_table_item")){e=$(".sorry-no .cart_table_item")[e];try{var t=$(e).attr("id").replace("dynamic_cart_table_item_","");$("#cart_table_item_"+t).hide()}catch(a){break}}for(var e in $(".sorry-no [id^=item_unavailable_]")){e=$(".sorry-no [id^=item_unavailable_]")[e];try{var t=$(e).attr("id").replace("item_unavailable_","");$("#cart_table_item_"+t).hide()}catch(a){break}}}page_cart_manipulations()};$(document).ready(function(){hideSorryNoItems(),catalogListAnalitics(),recommendationsListAnalitics()}),$(document).ready(function(){function e(){$(".background_overlay").show();var e=document.body,t=document.documentElement,a=window.pageYOffset||t.scrollTop||e.scrollTop,r=a+100;$("#registration_form1").css({top:r+"px","margin-left":"-260px"}).show(),$('input[name="cart_number"]').focus()}function t(){$(".absolute").hide(),$('input[name="cart_number"]').removeClass("invalid"),$("#registration_form1").hide()}function a(){$("#cart-registration-pop-up-1-1").hide(),$("#cart-registration-pop-up-1-3").show()}function r(e){setInterval(function(){if(0>e){var t="<a href=''>Получить пароль повторно</a>";return i.html(t),void clearInterval()}10>e&&(e="0"+e);var t='Получить пароль повторно можно через <span style="font-weight: bold">'+e+" секунд</span>";i.html(t),e--},1e3)}if($(".link_aut_cart").click(function(){return e(),!1}),$("#registration_form1 .link_aut").click(function(){t()}),$(".cart-registration-pop-up-go-phone").click(function(){a()}),$('input[name="cart_number"]').focus(function(){$(".absolute").hide(),$(this).removeClass("invalid")}),$('input[name="cart_number"]').keyup(function(){var e=$('input[name="cart_number"]').val();
if(""!==e){var t=/^[0-9]{1,16}$/i.test($.trim(e));t?$("#cart-registration-pop-up-1-1-button-yes").removeClass("grey_btn"):($("#cart-registration-pop-up-1-1-button-yes").addClass("grey_btn"),alert("Вводите только 16 цифр указанных на карте!"))}}),$("#cart-registration-pop-up-1-1-button-yes").click(function(){if(!$(this).hasClass("grey_btn")){$(".loader1").show();var e=$('input[name="cart_number"]').val();return $.ajax({url:"/udata/users/ai_register/",type:"POST",data:{mode:"card",card_number:e,from_page:"/",authType:"ajax"},dataType:"json",success:function(t){var a=$(t).find("status").text(),r=$(t).find("errorCode").text();return"OK"==a&&($("#cart-registration-pop-up-1-1").hide(),$("#cart-registration-pop-up-1-3").show(),cartUserAdd("cartUserNumber",e),cartUserAdd("cartUserId",$(t).find("user").text())),"error"==a&&($(".loader1").hide(),1001==r&&$('input[name="cart_number"]').addClass("invalid").siblings("div").eq(0).show(),1002==r&&$('input[name="cart_number"]').addClass("invalid").siblings("div").eq(1).show(),1003==r&&$('input[name="cart_number"]').addClass("invalid").siblings("div").eq(2).show(),1004==r&&$('input[name="cart_number"]').addClass("invalid").siblings("div").eq(3).show(),1005==r&&$('input[name="cart_number"]').addClass("invalid").siblings("div").eq(4).show()),!1}}),!1}}),$('input[name="phone_number"]').focus(function(){$(".absolute").hide(),$(this).removeClass("invalid")}),$('input[name="phone_number"]').keyup(function(){var e=$('input[name="phone_number"]').val();if(""!==e){var t=/^[0-9]{1,10}$/i.test($.trim(e));t?$("#cart-registration-pop-up-go-phone-code").removeClass("grey_btn"):($("#cart-registration-pop-up-go-phone-code").addClass("grey_btn"),alert("Вводите только 10 цифр номера талефона!"))}}),$(".time_over_phone_reg"))var i=$(".time_over_phone_reg");$("#cart-registration-pop-up-go-phone-code").click(function(){if(!$(this).hasClass("grey_btn")){var e=$('input[name="phone_number"]').val();return $.ajax({url:"/udata/users/ai_register/",type:"POST",data:{mode:"phone",phone:e,user:register.cartUserId,from_page:"/",authType:"ajax"},dataType:"XML",success:function(t){var a=$(t).find("status").text(),i=$(t).find("errorCode").text();return alert(a+" "+i),"OK"==a&&(cartUserAdd("phoneUser",e),alert(register.phoneUser),$("#cart-registration-pop-up-1-3").hide(),$("#cart-registration-pop-up-1-4").show(),$('input[name="phone-number-return"]').val(e),r(58)),"error"==a&&(2001==i&&($('input[name="phone_number"]').addClass("invalid"),$('input[name="phone_number"]').siblings("div").eq(0).show()),2002==i&&($('input[name="phone_number"]').addClass("invalid"),$('input[name="phone_number"]').siblings("div").eq(1).show())),!1}}),!1}}),$('input[name="phone_password"]').focus(function(){$(".absolute").hide(),$(this).removeClass("invalid")}),$('input[name="phone_password"]').keyup(function(){var e=$('input[name="phone_password"]').val();(e.length=0)?($("#cart-registration-pop-up-go-phone-code-password").addClass("grey_btn"),alert("Введите пароль!")):$("#cart-registration-pop-up-go-phone-code-password").removeClass("grey_btn")}),$("#cart-registration-pop-up-go-phone-code-password").click(function(){if(!$(this).hasClass("grey_btn")){var e=$('input[name="phone_password"]').val();return $.ajax({url:"/udata/users/ai_register/",type:"POST",data:{mode:"phone_confirm",sms_confirm_code:e,user:register.cartUserId,from_page:"/",authType:"ajax"},dataType:"XML",success:function(t){var a=$(t).find("status").text(),r=$(t).find("errorCode").text();return alert(a+" "+r),"OK"==a&&(cartUserAdd("phoneConfirm",e),alert(register.phoneConfirm),$("#cart-registration-pop-up-1-4").hide(),$("#cart-registration-pop-up-personal-date").show()),"error"==a&&($('input[name="phone_password"]').addClass("invalid"),$('input[name="phone_password"]').next().show()),!1}}),!1}}),$('input[name="shortname"]').focus(function(){$(".absolute").hide(),$(this).removeClass("invalid")}),$('input[name="shortname"]').keyup(function(){var e=$('input[name="shortname"]').val();""==e.length&&$(".person_date.submit").addClass("grey_btn"),""!=e.length&&$("input:checked#check_add_agreement")&&$(".person_date.submit").removeClass("grey_btn")}),$(".add_agreement").click(function(){var e=$('input[name="shortname"]').val();$("input:checked#check_add_agreement")||$(".person_date.submit").addClass("grey_btn"),$("input:checked#check_add_agreement")&&e&&""!=e.length&&$(".person_date.submit").removeClass("grey_btn")}),$(".person_date.submit").click(function(){if(!$(this).hasClass("grey_btn")){var e=$('input[name="shortname"]').val(),t=$('input[name="lname"]').val(),a=$('input[name="fname"]').val(),r=$('input[name="father_name"]').val(),i=$('select[name="day"]').val(),n=$('select[name="month"]').val(),o=$('select[name="year"]').val(),s=$('input[name="email"]').val();return $.ajax({url:"/udata/users/ai_register/",type:"POST",data:{mode:"personal_data",user_shortname:e,user_lname:t,user_fname:a,user_father_name:r,user_day:i,user_month:n,user_year:o,user_email:s,user:register.cartUserId,from_page:"/",authType:"ajax"},dataType:"XML",success:function(e){var t=$(e).find("status").text(),a=$(e).find("errorCode").text();return alert(t+" "+a),!1}}),!1}})});var promocodeValidated=0,haveGift=0,gifts_chenged=0,current_gift=0,future_amount=0,future_gift=0,global_discount_update=!1,timeErrors={MUST_DEFER_DISHES:"Необходимо отложить блюда",MUST_DEFER_PRODUCT:"Необходимо отложить продукты",NO_PRODUCTS:"У вас в корзине нет продуктов",NO_DISHES:"У вас в корзине нет товаров на заказа",INVALID_ORDER_TYPE:"Некорректный тип заказа",TIMESLOT_UNAVAILABLE:"Это время недоступно для выбранного типа заказа"};window.timeSlotsUpdate={update:!1,date:{},order_type:!1,active_tab:!1},$(document).ready(function(){order_controller={order:"",order_error:"",order_error_message:"",deliveryAddress:{fullAddressForGuest:"",addressDetailsForGuest:"",privateHouseForGuest:"",phoneDeliveryGuest:"",commentForGuest:"",coordinates:"",areaId:"",receiveCorrespondence:"",error:"",massage:"",uploadMapsScript:"",collection_address_data:function(){var e=$("#form_add_address_delivery");order_controller.deliveryAddress.fullAddressForGuest=e.find('textarea[name = "full_address_for_guest"]').val(),order_controller.deliveryAddress.addressDetailsForGuest=e.find('input[name = "address_details_for_guest"]').val(),order_controller.deliveryAddress.privateHouseForGuest=1*e.find('input[name="private_house_for_guest"][type="checkbox"]').is(":checked"),order_controller.deliveryAddress.phoneDeliveryGuest=e.find('input[name = "phone_delivery_for_guest"]').val(),order_controller.deliveryAddress.commentForGuest=e.find('textarea[name = "comment_for_guest"]').val(),order_controller.deliveryAddress.coordinates=e.find('input[name = "str_point"]').val(),order_controller.deliveryAddress.areaId=e.find('input[name = "area_search_id"]').val(),order_controller.deliveryAddress.receiveCorrespondence=e.find('input[name="correspondence"]').next(".checkbox").hasClass("checked"),order_controller.deliveryAddress.administrativeArea=e.find('input[name = "AdministrativeArea"]').val(),order_controller.deliveryAddress.subAdministrativeArea=e.find('input[name = "SubAdministrativeArea"]').val()},checkAddressForm:function(){var e=$("#form_add_address_delivery"),t=e.find(".required"),a=$("#button_add_address_for_guest"),r=$('input[name = "area_search_id"]').val();return"0"==r||""==r?($("#no_delivery").show(),order_controller.deliveryAddress.error=!0,a.addClass("grey_btn"),!1):void t.each(function(){var e=$(this),t=e.attr("name")+"_error",r=!e.val()&&!e.prop("disabled");return e.toggleClass("error",r),$("div#"+t).toggle(r),r?(order_controller.deliveryAddress.error=!0,a.addClass("grey_btn"),!1):(order_controller.deliveryAddress.error||a.removeClass("grey_btn"),void(order_controller.deliveryAddress.error=!1))})},upload_api_yandex_map_for_order:function(){function e(){var e=document.createElement("script");e.src="/templates/av/js/map_search.js?";var t=document.getElementsByTagName("head")[0];t.appendChild(e),e.onload=e.onerror=function(){this.executed||(this.executed=!0)},e.onreadystatechange=function(){var e=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){e.onload()},0)}}if(""!=order_controller.deliveryAddress.uploadMapsScript)return!1;order_controller.deliveryAddress.uploadMapsScript=!0;var t=document.createElement("script");t.src="http://api-maps.yandex.ru/2.0/?load=package.full&amp;mode=release&amp;lang=ru-RU";var a=document.getElementsByTagName("head")[0];return a.appendChild(t),t.onload=t.onerror=function(){this.executed||(this.executed=!0,e())},t.onreadystatechange=function(){var e=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){e.onload()},0)},!1},ajaxAddressAdd:function(){order_controller.deliveryAddress.collection_address_data(),$.ajax({url:"/udata/avemarket/set_delivery_address_guest/",type:"POST",data:{full_str_address:order_controller.deliveryAddress.fullAddressForGuest,coordinates:order_controller.deliveryAddress.coordinates,address_details:order_controller.deliveryAddress.addressDetailsForGuest,private_house:order_controller.deliveryAddress.privateHouseForGuest,area_id:order_controller.deliveryAddress.areaId,comment:order_controller.deliveryAddress.commentForGuest,phone:order_controller.deliveryAddress.phoneDeliveryGuest,receive_correspondence:order_controller.deliveryAddress.receiveCorrespondence,administrativeArea:order_controller.deliveryAddress.administrativeArea,subAdministrativeArea:order_controller.deliveryAddress.subAdministrativeArea},dataType:"xml",success:function(e){var t=$(e).find("status").text();return"OK"==t?(order_controller.deliveryAddress.massage="Адрес успешно добавлен",order_controller.deliveryAddress.hideModelWindowAddressDelivery()):"NO_DELIVERY"==t&&(order_controller.deliveryAddress.massage="Доставка по данному адресу невозможна, адрес только для корреспонденций"),update_block_cart(),!1}})},clickAddAddressForGuest:function(){return $(this).hasClass("grey_btn")?!1:(order_controller.deliveryAddress.checkAddressForm(),$(this).hasClass("grey_btn")?!1:(order_controller.deliveryAddress.error||(order_controller.deliveryAddress.ajaxAddressAdd(),order_controller.editTextAddressRightColumn()),update_block_cart(),!1))},selectPrivateHouse:function(e){e.stopPropagation();var t=$('input[name="address_details_for_guest"]');if(t.prop("disabled"))t.prop("disabled",!1);else{t.prop("disabled",!0).removeClass("error");var a=t.attr("name")+"_error";$("div#"+a).hide()}order_controller.deliveryAddress.checkAddressForm()},openModelWindowAddressDelivery:function(){return order_controller.deliveryAddress.upload_api_yandex_map_for_order(),$(".background_overlay").show(),$("#choice_address_delivery").show(),$("#address_delivery").attr("address")&&order_controller.deliveryAddress.checkAddressForm(),!1},hideModelWindowAddressDelivery:function(){$(".background_overlay").hide(),$("#choice_address_delivery").hide()},editDeliveryAddressDom:function(e){$("#address_delivery").html(e)},changeDeliveryAddress:function(){var e,t;return $(this).hasClass("select_address")?(e=$(this).siblings(".my_addresses_item_address").text(),t=$(this).attr("id").substring(5)):($("input[name = delivery_id][checked]").removeAttr("checked",""),$(this).attr("checked","checked"),e=$(this),t=e.val(),name_address=e.parent().find(".checkbox_label").text(),t=$.isNumeric(t)?parseInt(t):""),$.ajax({url:"/udata/avemarket/select_delivery_address/",type:"POST",data:{delivery_id:t},dataType:"xml",success:function(e){var t=$(e).find("udata").text();return"OK"==t?(order_controller.deliveryAddress.editDeliveryAddressDom(name_address),!1):(controlOrderingButtons(),!1)}}),order_controller.timeSlots.selectedTimeSlotsLeft(!0),$(this).hasClass("select_address")&&(window.location="/personal/basket/cart/"),!1}},blockBasket:{interval:0,updateIntervalToBasket:function(e){return clearInterval(order_controller.blockBasket.interval),$("#global_basket_update").length?void(order_controller.blockBasket.interval=setInterval(function(){update_block_cart()},1e3*e)):!1}},timeSlots:{intervalID_intervalUpdate:0,intervalID_SelectedTimeSlotsLeft:0,timeSlotChange:!1,showTimeSlotWindow:function(){$(".background_overlay").show();var e=document.body,t=document.documentElement,a=window.pageYOffset||t.scrollTop||e.scrollTop,r=a+100;return $("#time_slot_pop_up").css({top:r+"px","margin-left":"-360px"}).show(),window.timeSlotsUpdate.update?order_controller.timeSlots.startUpdateTimeSlots(60,!0):order_controller.timeSlots.updateTimeSlots(),!1},closeTimeSlotWindow:function(){if($(this).hasClass("g-hidden"))return!1;var e=$("div");return(e.is(".category_page_catalog")||e.is(".product_card")||e.is(".cart_header")||e.is(".user_account_my_lists")||e.is(".my_orders_item"))&&order_controller.timeSlots.timeSlotChange?($(".background_overlay").hide(),$("#time_slot_pop_up").hide()):($(".background_overlay").hide(),$("#time_slot_pop_up").hide()),order_controller.timeSlots.stopUpdateTimeSlots(),!1},closeButtonTimeSlotWindow:function(){var e=$(this).parents('[data-time="tabs-item"]'),t=e.find(".slot_time.active"),a=e.find('[data-time="error"]');order_controller.timeSlots.timeSlotChange=!0,show_loader_2();var r=t.attr("id").split("_"),i=r[1],n=r[3];$.ajax({url:"/udata/avemarket/select_delivery_time/"+i+"/1/"+n+"/",type:"POST",data:{slot_id:i,region_id:1,order_type:n},dataType:"xml",beforeSend:function(){a.text("").addClass("g-hidden")},success:function(e){hide_loader_2();var t=$(e).find("udata").text(),r=$(e).find("udata").attr("date"),i=$(e).find("udata").attr("interval");return $(".small_quantity").hide(),getBasketPrice(),timeErrors[t]?(a.text(timeErrors[t]).removeClass("g-hidden"),void order_controller.timeSlots.selectTimeSlotError(t)):(order_controller.timeSlots.editTimeSlotDom("OK",t,r,i),order_controller.drawButtonIssueOrderGuest(),$("#global_basket_update").length>0?(update_cart_block_visual(),update_deferred_block_visual(),updateRecommendationsBasket(),controlOrderingButtons()):document.location.reload(),order_controller.timeSlots.closeTimeSlotWindow(),order_controller.timeSlots.selectedTimeSlotsLeft(!0),!1)}})},selectDayTimeSlots:function(){var e=$(this).data();return $(this).parents('[data-time="tabs-item"]').find(".shedulte_block_tab_i").removeClass("active"),$(this).addClass("active"),window.timeSlotsUpdate.date[e.ordertype]=e.timedate,window.timeSlotsUpdate.order_type=e.ordertype,order_controller.timeSlots.startUpdateTimeSlots(60,!0),!1},editTimeSlotDom:function(e,t,a,r){var i=$("#time_delivery"),n=$(".js_link.time_slot_up"),o=$("#time_delivery_in_catalog"),s=$("#near_future_of_delivery"),d=$("#time_slot_ok");switch(e){case"OK":i.html(t),i.attr("time",t),n.html(t),$(".b-window__time-text").html(a+"<br/>"+r),o.html(t),o.show(),s.hide(),d.removeClass("grey_btn");break;case"NO":o.hide(),s.show(),i.removeAttr("time"),i.html("Время не выбрано"),n.html("Время не выбрано"),d.addClass("grey_btn")}},selectTimeSlot:function(){var e=$(this),t=$(this).parents('[data-time="tabs-item"]'),a=t.find('[data-button="time_slot_ok"]');return $(".slot_time").removeClass("active"),e.addClass("active"),t.find(".js_link.time_slot_up").addClass("b-window__time-text").html(e.data("visited-year")+"<br/>"+e.data("visited-time")),e.hasClass("not_active")?(a.addClass("g-hidden"),!1):a.hasClass("grey_btn")?!1:(a.removeClass("grey_btn g-hidden"),!1)},selectTimeSlotError:function(e){return $(".slot_time").removeClass("active"),order_controller.timeSlots.editTimeSlotDom("NO",e),order_controller.drawButtonIssueOrderGuest(),controlOrderingButtons(),order_controller.timeSlots.selectedTimeSlotsLeft(!0),!1},clickButtonSelectTimeSlot:function(){return $(this).hasClass("grey_btn")?!1:(document.location.href="/personal/basket/cart/",!1)},clickButtonCloseTimeSlits:function(){return $(this).hasClass("grey_btn")?!1:($(".background_overlay").hide(),$("#time_slot_pop_up").hide(),clearInterval(order_controller.timeSlots.intervalID_intervalUpdate),!1)},startUpdateTimeSlots:function(e,t){order_controller.timeSlots.stopUpdateTimeSlots(),t===!0&&order_controller.timeSlots.updateTimeDays(),order_controller.timeSlots.intervalID_intervalUpdate=setInterval(function(){order_controller.timeSlots.updateTimeDays()},1e3*e)},stopUpdateTimeSlots:function(){clearInterval(order_controller.timeSlots.intervalID_intervalUpdate)},initTabs:function(){$('[data-time="tabs"]').on("click","a",function(){return $(this).parent('[data-time="tabs"]').find("a").removeClass("b-tabs__item_active"),$(this).addClass("b-tabs__item_active"),$('[data-time="tabs-item"]').addClass("g-hidden"),$("#"+$(this).data("tab")).removeClass("g-hidden"),window.timeSlotsUpdate.active_tab=$("#"+$(this).data("tab")),window.timeSlotsUpdate.order_type=$("#"+$(this).data("tab")).data("ordertype"),order_controller.timeSlots.startUpdateTimeSlots(60,!0),!1})},initDatePicker:function(){$('[data-datepicker="true"]').each(function(){var e=$(this),t=e.data("id"),a=datepickerArray[t],r=e.parents('[data-time="tabs-item"]').data("ordertype");e.datepicker({inline:!0,dateFormat:"d.m.yy",minDate:a.minDayDatepicker,maxDate:a.maxDayDatepicker,onSelect:function(e){window.timeSlotsUpdate.date[r]=e,window.timeSlotsUpdate.order_type=r,order_controller.timeSlots.startUpdateTimeSlots(60,!0)},beforeShowDay:function(e){var t=e.getDate()+"."+(parseInt(e.getMonth())+1)+"."+e.getFullYear();return a.dayDatepicker[t]?{0:!0}:{0:!1}}}),e.datepicker("setDate",a.setDayDatepicker),window.timeSlotsUpdate.date[r]=a.setDayDatepicker})},updateTimeDays:function(e){var t,a;return e?(t=e.ordertype,a=e.timedate):(t=window.timeSlotsUpdate.order_type,a=window.timeSlotsUpdate.date[t]),t||a?($.ajax({url:"/udata/avemarket/getTimeSlotDay/"+t+"/"+a+"/",type:"GET",global:!1,async:!0,data:{transform:"modules/avemarket/time_slots.xsl"},dataType:"html",beforeSend:function(){window.timeSlotsUpdate.active_tab.find(".time_slot_preload").show(),window.timeSlotsUpdate.active_tab.find('[data-button="time_slot_ok"]').addClass("grey_btn g-hidden")},success:function(e){window.timeSlotsUpdate.active_tab.find(".time_slot_preload").hide(),window.timeSlotsUpdate.active_tab.find(".items_slot_div").html(e),update_block_cart()}}),!1):!1},updateTimeSlots:function(){return $.ajax({url:"/udata/avemarket/getTimeSlotDays/",type:"GET",global:!1,async:!0,data:{transform:"modules/avemarket/time_slots.xsl"},dataType:"html",beforeSend:function(){$("#time_slot_preload").show()},success:function(e){$("#time_slot_window_content").html(e),window.timeSlotsUpdate.update=!0,window.timeSlotsUpdate.active_tab=$("#time_slot_window_content").find('[data-time="tabs-item"]').filter(":not(.g-hidden)"),window.timeSlotsUpdate.order_type=window.timeSlotsUpdate.active_tab.data("ordertype"),$("#time_slot_window_content").find(".shedulte_block_tab_i.active").each(function(){var e=$(this).data();window.timeSlotsUpdate.date[e.ordertype]=e.timedate}),order_controller.timeSlots.initTabs(),order_controller.timeSlots.initDatePicker(),$("#time_slot_preload").hide(),order_controller.timeSlots.startUpdateTimeSlots(60,!0),controlOrderingButtons()}}),!1},selectedTimeSlotsLeft:function(e){function t(e){return 0>=n?(o.html(i(n)),hideReservGreenMessage(),showReservRedMessage(),setSelectedTimeEmpty(),void r()):(15>=n?(o.html(i(n)),s.html('<span class="fs10" style="color:red" title="Если вы не оформите заказ за оставшееся время, вам придется заново выбрать время доставки">Осталось '+i(n,!0)+"мин. на оформление заказа</span>")):(o.html(i(n)),s.html('<span class="fs10" title="Если вы не оформите заказ за оставшееся время, вам придется заново выбрать время доставки">Осталось '+i(n,!0)+"мин. на оформление заказа</span>")),void(n-=e||1))}function a(){var e=10;r(),t(e),order_controller.timeSlots.intervalID_SelectedTimeSlotsLeft=setInterval(function(){t(e)},1e3*e)}function r(){order_controller.timeSlots.intervalID_SelectedTimeSlotsLeft&&clearInterval(order_controller.timeSlots.intervalID_SelectedTimeSlotsLeft)}function i(e,t){var a,r;return e?(a=e/60>>0,r=e%60,a=10>a?"0"+a:a,r=10>r?"0"+r:r,t?a:a+":"+r):t?"00":"00:00"}var n=0,o=$("#cart_notify_clock"),s=$("#float_time_or_link");e===!0?$.ajax({url:"/udata/avemarket/calcDeliveryTimeLeft/",type:"POST",dataType:"xml",success:function(e){n=$(e).find("udata").text(),hideReservRedMessage(),hideReservGreenMessage(),("address-not-selected"==n||"time-not-selected"==n)&&(setSelectedTimeEmpty(),controlOrderingButtons()),a()}}):(n=$("#float_time_left").data("time")||0,a())}},openTabOrderDesign:function(){var e=$(this),t="."+$(this).attr("tab-body");$(".tab_order_design").removeClass("open"),$(".tab_body_order_design").hide(),e.addClass("open"),$(t).show()},editTextAddressRightColumn:function(){var e=$("#address_delivery");return e.html(order_controller.deliveryAddress.privateHouseForGuest?order_controller.deliveryAddress.fullAddressForGuest+", Частный дом":order_controller.deliveryAddress.fullAddressForGuest+", "+order_controller.deliveryAddress.addressDetailsForGuest),e.attr("address",order_controller.deliveryAddress.fullAddressForGuest),!1},ajaxSavePersonalData:function(){var e=$(this).attr("ajax-url"),t=$(this).attr("name"),a=$(this).val();$.ajax({url:"/udata/avemarket/"+e,type:"POST",data:{value:a},dataType:"xml",success:function(e){var a=$(e).find("status").text(),r="#personal_data_"+t+"_error",i=$(e).find("text").text(),n=$("#button_login_in_for_guest");return"OK"==a?("E-mail сохранен"==i&&$(n).hide(),$(r).hide()):("Введенный E-Mail уже используется"==i&&$(n).show(),$(r).show(),$(r).html(i)),order_controller.drawButtonIssueOrderGuest(),!1}})},changeTypePayment:function(){var e=$(this).find("span.checked").siblings("input").attr("id"),t=$(this).find("span.checked").siblings("input").val();"payment_credit_cards"==e?$(".online_description_cardpay").slideDown("fast"):$(".online_description_cardpay").slideUp("fast"),$.ajax({url:"/udata/avemarket/setSelectPayment/",type:"POST",data:{value:t},dataType:"xml",success:function(){return!1}})},checkDiscountCard:function(){global_discount_update=!0,$("#value_proc").hide();var e=$('select[name = "type_card"] option:selected').val(),t=$('input[name = "number_card"]').val(),a=$('select[name = "type_card"]').attr("card-index-id");return e||t?($.ajax({url:"/udata/avemarket/activateDiscountCard/",type:"POST",data:{type_card:e,number_card:t,card_img_id:a},dataType:"xml",success:function(e){var t=$(e).find("status").text(),a=$(e).find("text").text();"OK"==t?(show_loader_2(),location.reload()):($("#error_search_discount_card").show().text(a),$("#value_proc").hide(),global_discount_update=!1)}}),!1):!1},promoCode:{testApplicationPromoCode:function(e){var t=e.promo_applied,a=e.promo_benefit,r=e.promo_notification;$("#promo_benefit").html(a),1==t&&(""!==r||1!==r||0!==r?$("#promo_notification").html("notification: "+r).removeClass("display_none"):$("#promo_notification").html("").addClass("display_none"))}},gifts:{IsHaveGift:function(){$.ajax({url:"/udata/avemarket/cart",type:"POST",dataType:"xml",success:function(e){var t=$(e).find("udata").text("current_gift");haveGift=parseInt(t)>0?1:0}})},changeGiftNotification:function(e){$(".gift_header_pop_up .first_line").html(e),order_controller.gifts.showHideNotification()},showPromoBenefit:function(e,t){if(e&&"3"!=t){var a=e.split(".");$("#promo-code-basket").find('[data-code="item"]').html("-&nbsp;"+a[0]+' <span class="price_postfix">'+a[1]||"0</span>").end().removeClass("g-hidden")}else $("#promo-code-basket").find('[data-code="item"]').text("").end().addClass("g-hidden")},showHideNotification:function(){$(".gift_header_pop_up").addClass($(document).scrollTop()>0?"open":"open_in_header"),setTimeout(function(){$(".gift_header_pop_up").removeClass("open").removeClass("open_in_header")},6e3)},giftChengeCart:function(){$.ajax({url:"/udata/avemarket/cart/",type:"POST",dataType:"xml",success:function(e){var t=$(e).find("is_promo_gift").text();t=parseInt(t),0==parseInt(t)?$(".jift_cart_block_header").addClass("display_none"):($(".jift_cart_block_header").removeClass("display_none"),0==current_gift&&188266==future_gift?order_controller.gifts.dinamicChangeJift("1"):188266==current_gift&&62963==future_gift?order_controller.gifts.dinamicChangeJift("2"):62963==current_gift&&32578==future_gift?order_controller.gifts.dinamicChangeJift("3"):32578==current_gift&&0==future_gift&&order_controller.gifts.dinamicChangeJift("4"))}})},dinamicChangeJift:function(e){$(".gifts_static_block, .gifts_options").addClass("display_none"),$(".gifts_options.option_"+e).removeClass("display_none")}},ajaxRegistrationGuest:function(){return $.ajax({url:"/udata/avemarket/createUserByGuest/",type:"POST",dataType:"xml",async:!1,success:function(e){var t=$(e).find("status").text(),a=$(e).find("text").text(),r=$("#global_error_message");return"NO"==t?(hide_loader_2(),r.text(a),r.show(),!1):"OK"==t?(order_controller.ajaxPurchase(),!1):!1}}),!1},ajaxPurchase:function(){var e=$("#purchasing_for_guest"),t=$('textarea[name="order_comments_user"]').val(),a=$("#type_payment").find("span.checked").siblings("input").val();return $.ajax({url:"/udata/avemarket/purchase/",type:"POST",async:!1,data:{order_comments_user:t,type_payment:a},dataType:"xml",beforeSend:function(){e.parent().prev("#error_order").remove()},success:function(t){hide_loader_2();var a=($(t).find("status").text(),$(t).find("text").text(),$(t).find("udata").text());"OK"==a?document.location.href="/personal/basket/verification/":(e.attr("id","purchasing").off("click").on("click",order_controller.clickButtonMakeOrderUser),"UNAVAILABLE"==a?document.location.href="/personal/basket/unavailable/":"GIFT_NOT_SELECTED"==a?(e.parent().before(0==global_gift_count?'<div class="large-12 columns al_center error_message" id="error_order">Увеличьте сумму заказа до '+global_gift_min_order+' руб. и выберите подарок, либо <a href="#" id="promo_del_basket">отмените</a> промокод.</div>':'<div class="large-12 columns al_center fs13 error_message" id="error_order">Пожалуйста, выберите подарок</div>'),update_block_cart()):"GIFT_NOT_AVAILABLE"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Выбранный подарок недоступен для заказа</div>'),update_block_cart()):"PROMO_CODE_OUT_OF_DATE"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Срок действия промокода истек</div>'),update_block_cart()):"ERROR_LIMIT"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Превышен лимит использования промокода</div>'),update_block_cart()):"MUST_DEFER_DISHES"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Необходимо отложить Товары на заказ</div>'):"MUST_DEFER_PRODUCTS"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Необходимо отложить Продукты</div>'):"NO_PRODUCTS"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">У вас в корзине нет Продуктов</div>'):"NO_DISHES"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">У вас в корзине нет Товаров на заказа</div>'):"INVALID_ORDER_TYPE"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Некорректный тип заказа</div>'):"TIMESLOT_UNAVAILABLE"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Это время недоступно для выбранного типа заказа</div>'):"INSUFFICIENTAMOUNT"==a?($("body").animate({scrollTop:0},"slow"),$("#min_cash_shipping").removeClass("g-green")):location.reload())}}),!1},clickButtonMakeOrderGuest:function(){return ajax_modify_count_item_cart?!1:(show_loader_2(),order_controller.checkGlobalData(),order_controller.order_error?(order_controller.showAndHideGlobalError(),hide_loader_2(),!1):$(this).hasClass("grey_btn")?(hide_loader_2(),!1):(order_controller.ajaxRegistrationGuest(),!1))},clickButtonMakeOrderUser:function(){var e=$(this);if(ajax_modify_count_item_cart)return!1;if(!$(this).hasClass("grey_btn")){var t=$('textarea[name = "order_comments_user"]').val(),a=$('input[name = "type_payment"]:checked').val();return $.ajax({url:"/udata/avemarket/purchase/",type:"POST",data:{order_comments_user:t,type_payment:a},dataType:"xml",beforeSend:function(){e.parent().prev("#error_order").remove()},success:function(t){var a=$(t).find("udata").text();"OK"==a?document.location.href="/personal/basket/verification/":"UNAVAILABLE"==a?document.location.href="/personal/basket/unavailable/":"GIFT_NOT_SELECTED"==a?(e.parent().before(0==global_gift_count?'<div class="large-12 columns al_center error_message" id="error_order">Увеличьте сумму заказа до '+global_gift_min_order+' руб. и выберите подарок, либо <a href="#" id="promo_del_basket">отмените</a> промокод.</div>':'<div class="large-12 columns al_center fs13 error_message" id="error_order">Пожалуйста, выберите подарок</div>'),update_block_cart()):"GIFT_NOT_AVAILABLE"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Выбранный подарок недоступен для заказа</div>'),update_block_cart()):"PROMO_CODE_OUT_OF_DATE"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Срок действия промокода истек</div>'),update_block_cart()):"ERROR_LIMIT"==a?(e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Превышен лимит использования промокода</div>'),update_block_cart()):"MUST_DEFER_DISHES"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Необходимо отложить Товары на заказ</div>'):"MUST_DEFER_PRODUCTS"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Необходимо отложить Продукты</div>'):"NO_PRODUCTS"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">У вас в корзине нет Продуктов</div>'):"NO_DISHES"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">У вас в корзине нет Товаров на заказа</div>'):"INVALID_ORDER_TYPE"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Некорректный тип заказа</div>'):"TIMESLOT_UNAVAILABLE"==a?e.parent().before('<div class="large-12 columns al_center fs13 error_message" id="error_order">Это время недоступно для выбранного типа заказа</div>'):"INSUFFICIENTAMOUNT"==a?($("body").animate({scrollTop:0},"slow"),$("#min_cash_shipping").removeClass("g-green")):location.reload()}}),!1}return!1},clickButtonSuccessful:function(){var e=$('textarea[name = "order_comments_user"]').val(),t=$('input[name = "type_payment"]:checked').val();return show_loader_2(),$("#successful_two_error_gift").hide(),$.ajax({url:"/udata/avemarket/successful/",type:"POST",data:{order_comments_user:e,type_payment:t},dataType:"xml",success:function(e){var t=$(e).text();if("GIFT_UNAVAILABLE"==t)hide_loader_2(),$("#successful_two_error_gift").show();else if("INSUFFICIENTAMOUNT"==t)hide_loader_2(),$("#successful_two_error_min_amount").show();else{{var a=$(e).find("redirect").text(),r=$(e).find("order_id").text();$(e).find("total_price").text(),$(e).find("delivery_price").text(),$(e).find("country").text()}$.ajax({url:"/udata/avemarket/setOrderInQueueAjax/"+r,type:"POST",data:{orderId:r},dataType:"xml",success:function(){return a?(document.location.href=a,!1):(parseInt(r)?document.location.href="/personal/basket/successful/?order_id="+r:document.location.reload(),!1)},ajaxSend:function(){return a?(document.location.href=a,!1):(parseInt(r)?document.location.href="/personal/basket/successful/?order_id="+r:document.location.reload(),!1)}})}}}),!1},showAndHideGlobalError:function(){var e=$("#global_error_message");order_controller.order_error?e.html(order_controller.order_error_message).show():e.hide()},checkGlobalData:function(){var e=($(".min_cash_shipping:visible").length>0,$("#address_delivery").attr("address")),t=$("#time_delivery").attr("time"),a=$("#personal_data"),r=a.find('input[name="name_for_guest"]').val(),i=a.find('input[name="phone_for_guest"]').val(),n=a.find('input[name="email_for_guest"]').val(),o=$("#personal_data_email_for_guest_error").is(":visible"),s=$("#personal_data_phone_for_guest_error").is(":visible"),d=$(".cart_table_item").length>0,c=1*$('input[name="check_add_agreement"][type="checkbox"]').is(":checked");
return e?t?""==r?(order_controller.order_error=!0,order_controller.order_error_message="Не указано имя",!1):""==i?(order_controller.order_error=!0,order_controller.order_error_message="Не указан номер телефона",!1):""==n?(order_controller.order_error=!0,order_controller.order_error_message="Не указан e-mail",!1):d?o?(order_controller.order_error=!0,order_controller.order_error_message="Некорректный e-mail",!1):s?(order_controller.order_error=!0,order_controller.order_error_message="Некорректный телефон",!1):c?(order_controller.order_error=!1,!1):(order_controller.order_error=!0,order_controller.order_error_message="Вы не приняли условия соглашения",!1):(order_controller.order_error=!0,order_controller.order_error_message="Нет товаров в корзине",!1):(order_controller.order_error=!0,order_controller.order_error_message="Не выбрано время доставки.",!1):(order_controller.order_error=!0,order_controller.order_error_message="Мы не можем оформить заказ, пока вы не указали адрес доставки. Укажите пожалуйстa.",!1)},drawButtonIssueOrderGuest:function(){order_controller.checkGlobalData(),order_controller.order_error?$("#purchasing_for_guest").addClass("grey_btn"):$("#purchasing_for_guest").removeClass("grey_btn")},checkKeyUpPhone:function(){fieldPhone($(this))},clickSpamAllowed:function(){var e=1*!$('input[name="spam_allowed_for_guest"][type="checkbox"]').is(":checked");$.ajax({url:"/udata/avemarket/acceptSubscribes/",type:"POST",data:{value:e},dataType:"xml",success:function(){return!1}})},clickAddAgreement:function(){setTimeout(function(){order_controller.drawButtonIssueOrderGuest()},0)},attachEvents:function(){$("#open_window_address_delivery").on("click",order_controller.deliveryAddress.openModelWindowAddressDelivery),$("#tab_new_order_design, #tab_repeat_order_design").on("click",order_controller.openTabOrderDesign),$("#button_add_address_for_guest").on("click",order_controller.deliveryAddress.clickAddAddressForGuest),$('input[name = "delivery_id"]').on("change",order_controller.deliveryAddress.changeDeliveryAddress),$(".select_address").on("click",order_controller.deliveryAddress.changeDeliveryAddress),$("#open_window_time_slot").on("click",order_controller.timeSlots.showTimeSlotWindow),$("#time_slot_cancel").on("click",order_controller.timeSlots.clickButtonCloseTimeSlits),$(".time_slot_up").on("click",order_controller.timeSlots.showTimeSlotWindow),$(".time_slot_modal_window_close").on("click",order_controller.timeSlots.closeTimeSlotWindow),$(document).on("click",".shedulte_block_tab_i",order_controller.timeSlots.selectDayTimeSlots),$(document).delegate(".time_slots_all .slot_time","click",order_controller.timeSlots.selectTimeSlot),$(document).on("click","#time_slot_ok",order_controller.timeSlots.clickButtonSelectTimeSlot),$("#private_house_for_guest").on("change",order_controller.deliveryAddress.selectPrivateHouse),$("#personal_data textarea, #personal_data input").on("focusout",order_controller.ajaxSavePersonalData),$("#personal_data textarea, #personal_data input").keydown(function(e){return 13==e.keyCode?!1:void 0}),$("#type_payment").on("change",order_controller.changeTypePayment),$("#form_add_address_delivery .required").on("focusout",order_controller.deliveryAddress.checkAddressForm),$('#form_add_address_delivery input[name="address_details_for_guest"]').on("keyup",order_controller.deliveryAddress.checkAddressForm),$("#request_value_proc_guest").on("click",order_controller.checkDiscountCard),$('input[name="number_card"]').keydown(function(e){return 13==e.keyCode?($("#request_value_proc_guest").trigger("click"),!1):void 0}),$(".look_gift.link_line").click(function(){$("html, body").animate({scrollTop:$(".jift_cart_block_header").offset().top-55},800)}),$("#purchasing_for_guest").on("click",order_controller.clickButtonMakeOrderGuest),$("#purchasing").on("click",order_controller.clickButtonMakeOrderUser),$("#successful, #successful_two").on("click",order_controller.clickButtonSuccessful),$("input.phone").on("keyup",order_controller.checkKeyUpPhone),$('label[for="spam_allowed_for_guest"] .checkbox_label').on("click",order_controller.clickSpamAllowed),$('label[for="check_add_agreement"]').on("click",order_controller.clickAddAgreement),$(document).on("click",'[data-button="time_slot_ok"]',order_controller.timeSlots.closeButtonTimeSlotWindow),order_controller.drawButtonIssueOrderGuest(),order_controller.blockBasket.updateIntervalToBasket(60,!0),order_controller.timeSlots.selectedTimeSlotsLeft()}},order_controller.attachEvents()}),$(document).ready(function(){menu_controller={menuLinkActive:$(".main_menu a.active"),openMenuLevelTwo:function(){},clickBackCategory:function(){var e=$(this).closest(".products_categories_wrapper_other"),t=e.siblings(".products_categories_wrapper");return e.fadeOut(10),t.fadeIn(10),!1},clickMenuLevelOne:function(){var e=$(this).attr("id"),t=$(this).closest(".products_categories_wrapper"),a=$(this).closest(".products_categories_wrapper").attr("menu_id"),r=t.siblings(".products_categories_wrapper_other");if("new_year_1"==e?(t.fadeOut(200),$(".products_categories_wrapper_other.new_year_1").fadeIn(200)):"new_year_2"==e?(t.fadeOut(200),$(".products_categories_wrapper_other.new_year_2").fadeIn(200)):"new_year_3"==e?(t.fadeOut(200),$(".products_categories_wrapper_other.new_year_3").fadeIn(200)):"new_year_4"==e?(t.fadeOut(200),$(".products_categories_wrapper_other.new_year_4").fadeIn(200)):$.ajax({url:"/udata/catalog/menuCategory/"+a+"/"+e,type:"GET",async:!1,global:!1,data:{transform:"modules/menu/menu_ajax.xsl"},dataType:"html",success:function(e){r.html(e),linkSearchGet(r),t.fadeOut(200),r.fadeIn(200)}}),$(".parent_catalog_category_id").length>0)var i=$(".parent_catalog_category_id").text();else var i=$(".document-page-id").attr("data-document-page-id");var n=".dropdown-menu a#"+i;return $(".dropdown-menu a").removeClass("active-id-menu-two"),$(n).addClass("active-id-menu-two"),$(n).parents(".category-block").find(".category-block-header a").addClass("active-id-menu-two"),!1},eventFunction:function(){$(".header_menu_item_level_one").on("click",menu_controller.clickMenuLevelOne),$(".back_category").on("click",menu_controller.clickBackCategory),$(".products_categories_wrapper_other ").delegate("a.back_category","click",menu_controller.clickBackCategory)},dropdownMenuShowHide:function(){$(".main_menu menu>li>a").click(function(){return $(".expand_search_block.open").removeClass("open").find(".search_complete_wrapper").hide(),$(this).siblings(".products_categories_wrapper").length>0?($(this).siblings(".dropdown-menu:visible").length>0?($(".dropdown-menu").fadeOut(200),$(this).removeClass("active"),menu_controller.menuLinkActive.addClass("active")):($(".main_menu li a.active").removeClass("active"),$(this).addClass("active"),$(".dropdown-menu").fadeOut(200),$(this).siblings(".products_categories_wrapper").fadeIn(200)),!1):void $(".dropdown-menu").fadeOut(200)}),$("body, div , button").on("click",function(e){0==$(e.target).closest("menu").length&&($(".main_menu li a.active").removeClass("active"),menu_controller.menuLinkActive.addClass("active"),$(".dropdown-menu").fadeOut(200))})}},menu_controller.eventFunction(),menu_controller.dropdownMenuShowHide()}),$(document).ready(function(){window.ajax_slider=[],ajax_replace_slider("profitable"),ajax_replace_slider("recommended"),ajax_replace_slider("novelty"),ajax_replace_slider("special")});var block_names={profitable:"Выгодные покупки",recommended:"Рекомендуемые товары",novelty:"Новинки",special:"Специальные предложения"};$(function(){function e(e){var t={},a=$(e).find("items > item");if(a.length>0){t.ITEMS={};for(var r=0;r<a.length;r++){var i=$(a[r]);t.ITEMS[r]={ID:i.attr("id"),LINK:i.attr("link"),NAME:i.attr("name"),IMAGE:i.attr("photo_list"),PRICE:i.attr("price").split("."),PRICE_STYLE:i.attr("price_style"),STATUS:i.find("status").text()},i.find("warning").text()&&(t.ITEMS[r].WARNING=i.find("warning").text())}}return t.GROUP_MESSAGE=$(e).find("group_message").text(),$(e).find("next_gift_price").text()&&(t.GIFT_PRICE=$(e).find("next_gift_price").text()),$(e).find("next_gift_min_order").text()&&(t.GIFT_MIN_ORDER=$(e).find("next_gift_min_order").text()),$(e).find("group_message_error").text()&&(t.GROUP_MESSAGE_ERROR=$(e).find("group_message_error").text()),t}function t(e){if("object"==typeof e)return e;try{return $.parseJSON(e)}catch(t){return null}}$(document).on("promo_del_basket",function(){var e=$('input[name="promo_code_value"]');$.ajax({type:"POST",url:"/udata/avemarket/unsetPromoCode/"}).done(function(t){var a=$(t).find("udata").text();"ERROR_NO_PROMO_CODE"==a&&$("#promo_error").html("Промокод не привязан к корзине").removeClass("g-hidden"),$("#promo_success").html("").addClass("g-hidden"),$("#promo_message").addClass("g-hidden"),$("#promo_del").addClass("g-hidden"),e.val(""),global_promo_gifts_hash="",update_block_cart()})}),$("#promo_code_submit").on("click",function(){var e=$('input[name="promo_code_value"]');return""==e.val()?($("#promo_error").html("Введите промокод").removeClass("g-hidden"),e.addClass("error"),!1):($.ajax({type:"POST",url:"/udata/avemarket/setPromoCode/"+e.val()+"/",dataType:"json",beforeSend:function(){$("#promo_success").html("").addClass("g-hidden"),$("#promo_error").html("").addClass("g-hidden"),$("#promo_del").addClass("g-hidden"),e.removeClass("error")}}).done(function(e){return e=t(e),"ERROR"==e.status?($("#promo_error").html(e.message).removeClass("g-hidden"),!1):void("OK"==e.status&&($("#promo_success").html(e.message).removeClass("g-hidden"),$("#promo_message").removeClass("g-hidden"),$("#promo_del").removeClass("g-hidden"),update_block_cart()))}),!1)}),$("#promo_del").on("click",function(){return $(document).trigger("promo_del_basket"),!1}),$(document).on("click","#promo_del_basket",function(){return $(document).trigger("promo_del_basket"),$("#error_order").remove(),!1}),$('input[name="promo_code_value"]').keydown(function(e){return 13==e.keyCode?($("#promo_code_submit").trigger("click"),!1):void(""!=$(this).val()&&($(this).removeClass("error"),$("#promo_error").html("").addClass("g-hidden")))}),$("#gift-contener").on("update",function(){var t=_.template($("#template-gift-contener").html()),a=$("#gift-contener");$.ajax({type:"POST",url:"/udata/avemarket/getPromoGifts/"}).done(function(r){var i=$(r).find("hash").text();return i===global_promo_gifts_hash?!1:(global_promo_gifts_hash=i,global_gift_min_order=$(r).find("next_gift_min_order").text(),global_gift_count=$(r).find("items item").length,a.html(""),r=e(r),a.html(t({data:r})),a.find(".b-gift__preload").addClass("g-hidden"),void a.find(".b-gift__overlay").addClass("g-hidden"))})}),$("#gift-contener").on("click",'[data-set="gift"]',function(e){var t=$(e.target),a=t.parents("#gift-contener"),r=t.parents(".b-gift__item");return $.ajax({type:"POST",url:"/udata/avemarket/setGiftAddBasket/"+t.data("id")+"/",beforeSend:function(){a.find('[data-set="message"]').text("").addClass("g-hidden"),a.find(".b-gift__preload").removeClass("g-hidden"),a.find(".b-gift__overlay").removeClass("g-hidden")}}).done(function(e){e=$(e).find("udata").text(),"OK"==e?update_block_cart():"ERROR_CODE_TYPE"==e?r.find('[data-set="message"]').text("Ваш промокод не поддерживает получение подарка").removeClass("g-hidden"):"ERROR_NOT_FOUND"==e?r.find('[data-set="message"]').text("Товар не найден").removeClass("g-hidden"):"ERROR_NOT_AVAILABLE"==e?r.find('[data-set="message"]').text("Извините, этот товар закончился").removeClass("g-hidden"):"ERROR_OUT_OF_DATE"==e&&r.find('[data-set="message"]').text("Срок действия промокода истек").removeClass("g-hidden")}),!1})}),function(e,t){"use strict";var a=e(document);a.on("product-list-load",function(e,a){for(var r=0;r<a.items.length;r++){var i=a.items[r];t[0].ecommerce.impressions.push({id:i.id,list:a.name,position:i.position})}}),a.on("product-list-click",function(e,a){t.push({event:"productClick",ecommerce:{click:{actionField:{list:a.list},products:[{name:a.name,id:a.id,price:a.price,category:a.category}]}}})}),a.on("data-layer-basket",function(e,a,r){t.push({event:a,ecommerce:{currencyCode:"RUB",add:{products:[{name:r.name,id:r.id,price:r.price,category:r.category,quantity:r.quantity}]}}})}),a.on("products-add-to-cart",function(a,r){var i=[{name:r.name,id:r.id,price:r.price,category:r.category,quantity:r.quantity}];e.ajax({url:"/udata/avemarket/getPriceFlocktory/"+r.id+"/.json",type:"POST",dataType:"json",success:function(e){i[0].price=e.result,window.flocktory=window.flocktory||[],window.flocktory.push(["addToCart",{item:i}])}}),i[0].price=r.price,r.type&&"weighted"===r.type&&(i[0].quantity=1,i[0].weight=r.quantity,i[0].price=10*r.price*r.quantity),t.push({event:"addToCart",ecommerce:{currencyCode:"RUB",add:{products:i}}}),window.smartPixelAsyncLoad=function(){smartPixel1.trackState("add_to_cart",{cart_items:[{price:r.price,id:r.id,quantity:r.quantity}]})}}),a.on("products-remove-from-cart",function(a,r){var i=[{name:r.name,id:r.id,price:r.price,category:r.category,quantity:r.quantity}];e.ajax({url:"/udata/avemarket/getPriceFlocktory/"+r.id+"/.json",type:"POST",dataType:"json",success:function(e){i[0].price=e.result,window.flocktory=window.flocktory||[],window.flocktory.push(["removeFromCart",{item:i}])}}),i[0].price=r.price,r.type&&"weighted"===r.type&&(i[0].quantity=1,i[0].weight=r.quantity,i[0].price=10*r.price*r.quantity),t.push({event:"removeFromCart",ecommerce:{remove:{products:i}}}),window.smartPixelAsyncLoad=function(){smartPixel1.trackState("remove_from_cart",{cart_items:[{price:r.price,id:r.id,quantity:r.quantity}]})}}),a.on("click",".js-universal-promo",function(){var a=e(this).data();t.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[a]}}})}),a.ajaxComplete(function(a,r){var i=r.getResponseHeader("X-Data-Layer-Params");i&&(i=e.parseJSON(i)),i&&t.push(i)}),a.on("data-layer-load",function(){4===window.ajax_slider.length&&!function(e,t,a,r,i){e[r]=e[r]||[],e[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var n=t.getElementsByTagName(a)[0],o=t.createElement(a),s="dataLayer"!=r?"&amp;l="+r:"";o.async=!0,o.src="//www.googletagmanager.com/gtm.js?id="+i+s,n.parentNode.insertBefore(o,n)}(window,document,"script","dataLayer","GTM-NX4B6Q")})}(jQuery,dataLayer);